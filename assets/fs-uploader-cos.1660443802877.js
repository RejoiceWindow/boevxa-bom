import{u as useUploader,b as buildKey}from"./index2.1660443802877.js";import{m as commonjsGlobal,F as commonjsRequire,B as _export_sfc,l as lodash,h as dayjs}from"./index.1660443802877.js";import{j as openBlock,k as createElementBlock,g as getCurrentInstance}from"./vue.1660443802877.js";var md5$1={exports:{}};(function(module){(function(){var ERROR="input is invalid type",WINDOW=typeof window=="object",root=WINDOW?window:{};root.JS_MD5_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&typeof self=="object",NODE_JS=!root.JS_MD5_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;NODE_JS?root=commonjsGlobal:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&!0&&module.exports,ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&typeof ArrayBuffer!="undefined",HEX_CHARS="0123456789abcdef".split(""),EXTRA=[128,32768,8388608,-2147483648],SHIFT=[0,8,16,24],OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"],BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),blocks=[],buffer8;if(ARRAY_BUFFER){var buffer=new ArrayBuffer(68);buffer8=new Uint8Array(buffer),blocks=new Uint32Array(buffer)}(root.JS_MD5_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"}),ARRAY_BUFFER&&(root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(e){return typeof e=="object"&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(e){return function(n,t){return new Md5(!0).update(n,t)[e]()}},createMethod=function(){var e=createOutputMethod("hex");NODE_JS&&(e=nodeWrap(e)),e.getCtx=e.create=function(){return new Md5},e.update=function(i){return e.create().update(i)};for(var n=0;n<OUTPUT_TYPES.length;++n){var t=OUTPUT_TYPES[n];e[t]=createOutputMethod(t)}return e},nodeWrap=function(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(e){if(typeof e=="string")return crypto.createHash("md5").update(e,"utf8").digest("hex");if(e==null)throw ERROR;return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash("md5").update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod};function Md5(e){if(e)blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks,this.buffer8=buffer8;else if(ARRAY_BUFFER){var n=new ArrayBuffer(68);this.buffer8=new Uint8Array(n),this.blocks=new Uint32Array(n)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Md5.prototype.update=function(e,n){if(!this.finalized){for(var t,i=0,o,r=e.length,s=this.blocks,u=this.buffer8;i<r;){if(this.hashed&&(this.hashed=!1,s[0]=s[16],s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),ARRAY_BUFFER)for(o=this.start;i<r&&o<64;++i)t=e.charCodeAt(i),n||t<128?u[o++]=t:t<2048?(u[o++]=192|t>>6,u[o++]=128|t&63):t<55296||t>=57344?(u[o++]=224|t>>12,u[o++]=128|t>>6&63,u[o++]=128|t&63):(t=65536+((t&1023)<<10|e.charCodeAt(++i)&1023),u[o++]=240|t>>18,u[o++]=128|t>>12&63,u[o++]=128|t>>6&63,u[o++]=128|t&63);else for(o=this.start;i<r&&o<64;++i)t=e.charCodeAt(i),n||t<128?s[o>>2]|=t<<SHIFT[o++&3]:t<2048?(s[o>>2]|=(192|t>>6)<<SHIFT[o++&3],s[o>>2]|=(128|t&63)<<SHIFT[o++&3]):t<55296||t>=57344?(s[o>>2]|=(224|t>>12)<<SHIFT[o++&3],s[o>>2]|=(128|t>>6&63)<<SHIFT[o++&3],s[o>>2]|=(128|t&63)<<SHIFT[o++&3]):(t=65536+((t&1023)<<10|e.charCodeAt(++i)&1023),s[o>>2]|=(240|t>>18)<<SHIFT[o++&3],s[o>>2]|=(128|t>>12&63)<<SHIFT[o++&3],s[o>>2]|=(128|t>>6&63)<<SHIFT[o++&3],s[o>>2]|=(128|t&63)<<SHIFT[o++&3]);this.lastByteIndex=o,this.bytes+=o-this.start,o>=64?(this.start=o-64,this.hash(),this.hashed=!0):this.start=o}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Md5.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,n=this.lastByteIndex;e[n>>2]|=EXTRA[n&3],n>=56&&(this.hashed||this.hash(),e[0]=e[16],e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.bytes<<3,e[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},Md5.prototype.hash=function(){var e,n,t,i,o,r,s=this.blocks;this.first?(e=s[0]-680876937,e=(e<<7|e>>>25)-271733879<<0,i=(-1732584194^e&2004318071)+s[1]-117830708,i=(i<<12|i>>>20)+e<<0,t=(-271733879^i&(e^-271733879))+s[2]-1126478375,t=(t<<17|t>>>15)+i<<0,n=(e^t&(i^e))+s[3]-1316259209,n=(n<<22|n>>>10)+t<<0):(e=this.h0,n=this.h1,t=this.h2,i=this.h3,e+=(i^n&(t^i))+s[0]-680876936,e=(e<<7|e>>>25)+n<<0,i+=(t^e&(n^t))+s[1]-389564586,i=(i<<12|i>>>20)+e<<0,t+=(n^i&(e^n))+s[2]+606105819,t=(t<<17|t>>>15)+i<<0,n+=(e^t&(i^e))+s[3]-1044525330,n=(n<<22|n>>>10)+t<<0),e+=(i^n&(t^i))+s[4]-176418897,e=(e<<7|e>>>25)+n<<0,i+=(t^e&(n^t))+s[5]+1200080426,i=(i<<12|i>>>20)+e<<0,t+=(n^i&(e^n))+s[6]-1473231341,t=(t<<17|t>>>15)+i<<0,n+=(e^t&(i^e))+s[7]-45705983,n=(n<<22|n>>>10)+t<<0,e+=(i^n&(t^i))+s[8]+1770035416,e=(e<<7|e>>>25)+n<<0,i+=(t^e&(n^t))+s[9]-1958414417,i=(i<<12|i>>>20)+e<<0,t+=(n^i&(e^n))+s[10]-42063,t=(t<<17|t>>>15)+i<<0,n+=(e^t&(i^e))+s[11]-1990404162,n=(n<<22|n>>>10)+t<<0,e+=(i^n&(t^i))+s[12]+1804603682,e=(e<<7|e>>>25)+n<<0,i+=(t^e&(n^t))+s[13]-40341101,i=(i<<12|i>>>20)+e<<0,t+=(n^i&(e^n))+s[14]-1502002290,t=(t<<17|t>>>15)+i<<0,n+=(e^t&(i^e))+s[15]+1236535329,n=(n<<22|n>>>10)+t<<0,e+=(t^i&(n^t))+s[1]-165796510,e=(e<<5|e>>>27)+n<<0,i+=(n^t&(e^n))+s[6]-1069501632,i=(i<<9|i>>>23)+e<<0,t+=(e^n&(i^e))+s[11]+643717713,t=(t<<14|t>>>18)+i<<0,n+=(i^e&(t^i))+s[0]-373897302,n=(n<<20|n>>>12)+t<<0,e+=(t^i&(n^t))+s[5]-701558691,e=(e<<5|e>>>27)+n<<0,i+=(n^t&(e^n))+s[10]+38016083,i=(i<<9|i>>>23)+e<<0,t+=(e^n&(i^e))+s[15]-660478335,t=(t<<14|t>>>18)+i<<0,n+=(i^e&(t^i))+s[4]-405537848,n=(n<<20|n>>>12)+t<<0,e+=(t^i&(n^t))+s[9]+568446438,e=(e<<5|e>>>27)+n<<0,i+=(n^t&(e^n))+s[14]-1019803690,i=(i<<9|i>>>23)+e<<0,t+=(e^n&(i^e))+s[3]-187363961,t=(t<<14|t>>>18)+i<<0,n+=(i^e&(t^i))+s[8]+1163531501,n=(n<<20|n>>>12)+t<<0,e+=(t^i&(n^t))+s[13]-1444681467,e=(e<<5|e>>>27)+n<<0,i+=(n^t&(e^n))+s[2]-51403784,i=(i<<9|i>>>23)+e<<0,t+=(e^n&(i^e))+s[7]+1735328473,t=(t<<14|t>>>18)+i<<0,n+=(i^e&(t^i))+s[12]-1926607734,n=(n<<20|n>>>12)+t<<0,o=n^t,e+=(o^i)+s[5]-378558,e=(e<<4|e>>>28)+n<<0,i+=(o^e)+s[8]-2022574463,i=(i<<11|i>>>21)+e<<0,r=i^e,t+=(r^n)+s[11]+1839030562,t=(t<<16|t>>>16)+i<<0,n+=(r^t)+s[14]-35309556,n=(n<<23|n>>>9)+t<<0,o=n^t,e+=(o^i)+s[1]-1530992060,e=(e<<4|e>>>28)+n<<0,i+=(o^e)+s[4]+1272893353,i=(i<<11|i>>>21)+e<<0,r=i^e,t+=(r^n)+s[7]-155497632,t=(t<<16|t>>>16)+i<<0,n+=(r^t)+s[10]-1094730640,n=(n<<23|n>>>9)+t<<0,o=n^t,e+=(o^i)+s[13]+681279174,e=(e<<4|e>>>28)+n<<0,i+=(o^e)+s[0]-358537222,i=(i<<11|i>>>21)+e<<0,r=i^e,t+=(r^n)+s[3]-722521979,t=(t<<16|t>>>16)+i<<0,n+=(r^t)+s[6]+76029189,n=(n<<23|n>>>9)+t<<0,o=n^t,e+=(o^i)+s[9]-640364487,e=(e<<4|e>>>28)+n<<0,i+=(o^e)+s[12]-421815835,i=(i<<11|i>>>21)+e<<0,r=i^e,t+=(r^n)+s[15]+530742520,t=(t<<16|t>>>16)+i<<0,n+=(r^t)+s[2]-995338651,n=(n<<23|n>>>9)+t<<0,e+=(t^(n|~i))+s[0]-198630844,e=(e<<6|e>>>26)+n<<0,i+=(n^(e|~t))+s[7]+1126891415,i=(i<<10|i>>>22)+e<<0,t+=(e^(i|~n))+s[14]-1416354905,t=(t<<15|t>>>17)+i<<0,n+=(i^(t|~e))+s[5]-57434055,n=(n<<21|n>>>11)+t<<0,e+=(t^(n|~i))+s[12]+1700485571,e=(e<<6|e>>>26)+n<<0,i+=(n^(e|~t))+s[3]-1894986606,i=(i<<10|i>>>22)+e<<0,t+=(e^(i|~n))+s[10]-1051523,t=(t<<15|t>>>17)+i<<0,n+=(i^(t|~e))+s[1]-2054922799,n=(n<<21|n>>>11)+t<<0,e+=(t^(n|~i))+s[8]+1873313359,e=(e<<6|e>>>26)+n<<0,i+=(n^(e|~t))+s[15]-30611744,i=(i<<10|i>>>22)+e<<0,t+=(e^(i|~n))+s[6]-1560198380,t=(t<<15|t>>>17)+i<<0,n+=(i^(t|~e))+s[13]+1309151649,n=(n<<21|n>>>11)+t<<0,e+=(t^(n|~i))+s[4]-145523070,e=(e<<6|e>>>26)+n<<0,i+=(n^(e|~t))+s[11]-1120210379,i=(i<<10|i>>>22)+e<<0,t+=(e^(i|~n))+s[2]+718787259,t=(t<<15|t>>>17)+i<<0,n+=(i^(t|~e))+s[9]-343485551,n=(n<<21|n>>>11)+t<<0,this.first?(this.h0=e+1732584193<<0,this.h1=n-271733879<<0,this.h2=t-1732584194<<0,this.h3=i+271733878<<0,this.first=!1):(this.h0=this.h0+e<<0,this.h1=this.h1+n<<0,this.h2=this.h2+t<<0,this.h3=this.h3+i<<0)},Md5.prototype.hex=function(){this.finalize();var e=this.h0,n=this.h1,t=this.h2,i=this.h3;return HEX_CHARS[e>>4&15]+HEX_CHARS[e&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[n&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[t&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[i&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]},Md5.prototype.toString=Md5.prototype.hex,Md5.prototype.digest=function(e){if(e==="hex")return this.hex();this.finalize();var n=this.h0,t=this.h1,i=this.h2,o=this.h3,r=[n&255,n>>8&255,n>>16&255,n>>24&255,t&255,t>>8&255,t>>16&255,t>>24&255,i&255,i>>8&255,i>>16&255,i>>24&255,o&255,o>>8&255,o>>16&255,o>>24&255];return r},Md5.prototype.array=Md5.prototype.digest,Md5.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(16),n=new Uint32Array(e);return n[0]=this.h0,n[1]=this.h1,n[2]=this.h2,n[3]=this.h3,e},Md5.prototype.buffer=Md5.prototype.arrayBuffer,Md5.prototype.base64=function(){for(var e,n,t,i="",o=this.array(),r=0;r<15;)e=o[r++],n=o[r++],t=o[r++],i+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[(e<<4|n>>>4)&63]+BASE64_ENCODE_CHAR[(n<<2|t>>>6)&63]+BASE64_ENCODE_CHAR[t&63];return e=o[r],i+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[e<<4&63]+"==",i};var exports=createMethod();COMMON_JS?module.exports=exports:root.md5=exports})()})(md5$1);var crypto={exports:{}};(function(e){var n=n||function(t,i){var o={},r=o.lib={},s=function(){},u=r.Base={extend:function(g){s.prototype=this;var h=new s;return g&&h.mixIn(g),h.hasOwnProperty("init")||(h.init=function(){h.$super.init.apply(this,arguments)}),h.init.prototype=h,h.$super=this,h},create:function(){var g=this.extend();return g.init.apply(g,arguments),g},init:function(){},mixIn:function(g){for(var h in g)g.hasOwnProperty(h)&&(this[h]=g[h]);g.hasOwnProperty("toString")&&(this.toString=g.toString)},clone:function(){return this.init.prototype.extend(this)}},c=r.WordArray=u.extend({init:function(g,h){g=this.words=g||[],this.sigBytes=h!=i?h:4*g.length},toString:function(g){return(g||l).stringify(this)},concat:function(g){var h=this.words,C=g.words,p=this.sigBytes;if(g=g.sigBytes,this.clamp(),p%4)for(var v=0;v<g;v++)h[p+v>>>2]|=(C[v>>>2]>>>24-8*(v%4)&255)<<24-8*((p+v)%4);else if(65535<C.length)for(v=0;v<g;v+=4)h[p+v>>>2]=C[v>>>2];else h.push.apply(h,C);return this.sigBytes+=g,this},clamp:function(){var g=this.words,h=this.sigBytes;g[h>>>2]&=4294967295<<32-8*(h%4),g.length=t.ceil(h/4)},clone:function(){var g=u.clone.call(this);return g.words=this.words.slice(0),g},random:function(g){for(var h=[],C=0;C<g;C+=4)h.push(4294967296*t.random()|0);return new c.init(h,g)}}),f=o.enc={},l=f.Hex={stringify:function(g){var h=g.words;g=g.sigBytes;for(var C=[],p=0;p<g;p++){var v=h[p>>>2]>>>24-8*(p%4)&255;C.push((v>>>4).toString(16)),C.push((v&15).toString(16))}return C.join("")},parse:function(g){for(var h=g.length,C=[],p=0;p<h;p+=2)C[p>>>3]|=parseInt(g.substr(p,2),16)<<24-4*(p%8);return new c.init(C,h/2)}},a=f.Latin1={stringify:function(g){var h=g.words;g=g.sigBytes;for(var C=[],p=0;p<g;p++)C.push(String.fromCharCode(h[p>>>2]>>>24-8*(p%4)&255));return C.join("")},parse:function(g){for(var h=g.length,C=[],p=0;p<h;p++)C[p>>>2]|=(g.charCodeAt(p)&255)<<24-8*(p%4);return new c.init(C,h)}},d=f.Utf8={stringify:function(g){try{return decodeURIComponent(escape(a.stringify(g)))}catch{throw Error("Malformed UTF-8 data")}},parse:function(g){return a.parse(unescape(encodeURIComponent(g)))}},y=r.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(g){typeof g=="string"&&(g=d.parse(g)),this._data.concat(g),this._nDataBytes+=g.sigBytes},_process:function(g){var h=this._data,C=h.words,p=h.sigBytes,v=this.blockSize,S=p/(4*v),S=g?t.ceil(S):t.max((S|0)-this._minBufferSize,0);if(g=S*v,p=t.min(4*g,p),g){for(var E=0;E<g;E+=v)this._doProcessBlock(C,E);E=C.splice(0,g),h.sigBytes-=p}return new c.init(E,p)},clone:function(){var g=u.clone.call(this);return g._data=this._data.clone(),g},_minBufferSize:0});r.Hasher=y.extend({cfg:u.extend(),init:function(g){this.cfg=this.cfg.extend(g),this.reset()},reset:function(){y.reset.call(this),this._doReset()},update:function(g){return this._append(g),this._process(),this},finalize:function(g){return g&&this._append(g),this._doFinalize()},blockSize:16,_createHelper:function(g){return function(h,C){return new g.init(C).finalize(h)}},_createHmacHelper:function(g){return function(h,C){return new R.HMAC.init(g,C).finalize(h)}}});var R=o.algo={};return o}(Math);(function(){var t=n,s=t.lib,i=s.WordArray,o=s.Hasher,r=[],s=t.algo.SHA1=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,c){for(var f=this._hash.words,l=f[0],a=f[1],d=f[2],y=f[3],R=f[4],g=0;80>g;g++){if(16>g)r[g]=u[c+g]|0;else{var h=r[g-3]^r[g-8]^r[g-14]^r[g-16];r[g]=h<<1|h>>>31}h=(l<<5|l>>>27)+R+r[g],h=20>g?h+((a&d|~a&y)+1518500249):40>g?h+((a^d^y)+1859775393):60>g?h+((a&d|a&y|d&y)-1894007588):h+((a^d^y)-899497514),R=y,y=d,d=a<<30|a>>>2,a=l,l=h}f[0]=f[0]+l|0,f[1]=f[1]+a|0,f[2]=f[2]+d|0,f[3]=f[3]+y|0,f[4]=f[4]+R|0},_doFinalize:function(){var u=this._data,c=u.words,f=8*this._nDataBytes,l=8*u.sigBytes;return c[l>>>5]|=128<<24-l%32,c[(l+64>>>9<<4)+14]=Math.floor(f/4294967296),c[(l+64>>>9<<4)+15]=f,u.sigBytes=4*c.length,this._process(),this._hash},clone:function(){var u=o.clone.call(this);return u._hash=this._hash.clone(),u}});t.SHA1=o._createHelper(s),t.HmacSHA1=o._createHmacHelper(s)})(),function(){var t=n,i=t.enc.Utf8;t.algo.HMAC=t.lib.Base.extend({init:function(o,r){o=this._hasher=new o.init,typeof r=="string"&&(r=i.parse(r));var s=o.blockSize,u=4*s;r.sigBytes>u&&(r=o.finalize(r)),r.clamp();for(var c=this._oKey=r.clone(),f=this._iKey=r.clone(),l=c.words,a=f.words,d=0;d<s;d++)l[d]^=1549556828,a[d]^=909522486;c.sigBytes=f.sigBytes=u,this.reset()},reset:function(){var o=this._hasher;o.reset(),o.update(this._iKey)},update:function(o){return this._hasher.update(o),this},finalize:function(o){var r=this._hasher;return o=r.finalize(o),r.reset(),r.finalize(this._oKey.clone().concat(o))}})}(),function(){var t=n,i=t.lib,o=i.WordArray,r=t.enc;r.Base64={stringify:function(s){var u=s.words,c=s.sigBytes,f=this._map;s.clamp();for(var l=[],a=0;a<c;a+=3)for(var d=u[a>>>2]>>>24-a%4*8&255,y=u[a+1>>>2]>>>24-(a+1)%4*8&255,R=u[a+2>>>2]>>>24-(a+2)%4*8&255,g=d<<16|y<<8|R,h=0;h<4&&a+h*.75<c;h++)l.push(f.charAt(g>>>6*(3-h)&63));var C=f.charAt(64);if(C)for(;l.length%4;)l.push(C);return l.join("")},parse:function(s){var u=s.length,c=this._map,f=c.charAt(64);if(f){var l=s.indexOf(f);l!=-1&&(u=l)}for(var a=[],d=0,y=0;y<u;y++)if(y%4){var R=c.indexOf(s.charAt(y-1))<<y%4*2,g=c.indexOf(s.charAt(y))>>>6-y%4*2;a[d>>>2]|=(R|g)<<24-d%4*8,d++}return o.create(a,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.exports=n})(crypto);var lib={},dom$2={},conventions$2={};function freeze(e,n){return n===void 0&&(n=Object),n&&typeof n.freeze=="function"?n.freeze(e):e}function assign(e,n){if(e===null||typeof e!="object")throw new TypeError("target is not an object");for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e}var MIME_TYPE=freeze({HTML:"text/html",isHTML:function(e){return e===MIME_TYPE.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),NAMESPACE$3=freeze({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(e){return e===NAMESPACE$3.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});conventions$2.assign=assign;conventions$2.freeze=freeze;conventions$2.MIME_TYPE=MIME_TYPE;conventions$2.NAMESPACE=NAMESPACE$3;var conventions$1=conventions$2,NAMESPACE$2=conventions$1.NAMESPACE;function notEmptyString(e){return e!==""}function splitOnASCIIWhitespace(e){return e?e.split(/[\t\n\f\r ]+/).filter(notEmptyString):[]}function orderedSetReducer(e,n){return e.hasOwnProperty(n)||(e[n]=!0),e}function toOrderedSet(e){if(!e)return[];var n=splitOnASCIIWhitespace(e);return Object.keys(n.reduce(orderedSetReducer,{}))}function arrayIncludes(e){return function(n){return e&&e.indexOf(n)!==-1}}function copy(e,n){for(var t in e)n[t]=e[t]}function _extends(e,n){var t=e.prototype;if(!(t instanceof n)){let i=function(){};i.prototype=n.prototype,i=new i,copy(t,i),e.prototype=t=i}t.constructor!=e&&(typeof e!="function"&&console.error("unknown Class:"+e),t.constructor=e)}var NodeType={},ELEMENT_NODE=NodeType.ELEMENT_NODE=1,ATTRIBUTE_NODE=NodeType.ATTRIBUTE_NODE=2,TEXT_NODE=NodeType.TEXT_NODE=3,CDATA_SECTION_NODE=NodeType.CDATA_SECTION_NODE=4,ENTITY_REFERENCE_NODE=NodeType.ENTITY_REFERENCE_NODE=5,ENTITY_NODE=NodeType.ENTITY_NODE=6,PROCESSING_INSTRUCTION_NODE=NodeType.PROCESSING_INSTRUCTION_NODE=7,COMMENT_NODE=NodeType.COMMENT_NODE=8,DOCUMENT_NODE=NodeType.DOCUMENT_NODE=9,DOCUMENT_TYPE_NODE=NodeType.DOCUMENT_TYPE_NODE=10,DOCUMENT_FRAGMENT_NODE=NodeType.DOCUMENT_FRAGMENT_NODE=11,NOTATION_NODE=NodeType.NOTATION_NODE=12,ExceptionCode={},ExceptionMessage={};ExceptionCode.INDEX_SIZE_ERR=(ExceptionMessage[1]="Index size error",1);ExceptionCode.DOMSTRING_SIZE_ERR=(ExceptionMessage[2]="DOMString size error",2);var HIERARCHY_REQUEST_ERR=ExceptionCode.HIERARCHY_REQUEST_ERR=(ExceptionMessage[3]="Hierarchy request error",3);ExceptionCode.WRONG_DOCUMENT_ERR=(ExceptionMessage[4]="Wrong document",4);ExceptionCode.INVALID_CHARACTER_ERR=(ExceptionMessage[5]="Invalid character",5);ExceptionCode.NO_DATA_ALLOWED_ERR=(ExceptionMessage[6]="No data allowed",6);ExceptionCode.NO_MODIFICATION_ALLOWED_ERR=(ExceptionMessage[7]="No modification allowed",7);var NOT_FOUND_ERR=ExceptionCode.NOT_FOUND_ERR=(ExceptionMessage[8]="Not found",8);ExceptionCode.NOT_SUPPORTED_ERR=(ExceptionMessage[9]="Not supported",9);var INUSE_ATTRIBUTE_ERR=ExceptionCode.INUSE_ATTRIBUTE_ERR=(ExceptionMessage[10]="Attribute in use",10);ExceptionCode.INVALID_STATE_ERR=(ExceptionMessage[11]="Invalid state",11);ExceptionCode.SYNTAX_ERR=(ExceptionMessage[12]="Syntax error",12);ExceptionCode.INVALID_MODIFICATION_ERR=(ExceptionMessage[13]="Invalid modification",13);ExceptionCode.NAMESPACE_ERR=(ExceptionMessage[14]="Invalid namespace",14);ExceptionCode.INVALID_ACCESS_ERR=(ExceptionMessage[15]="Invalid access",15);function DOMException(e,n){if(n instanceof Error)var t=n;else t=this,Error.call(this,ExceptionMessage[e]),this.message=ExceptionMessage[e],Error.captureStackTrace&&Error.captureStackTrace(this,DOMException);return t.code=e,n&&(this.message=this.message+": "+n),t}DOMException.prototype=Error.prototype;copy(ExceptionCode,DOMException);function NodeList(){}NodeList.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,n){for(var t=[],i=0;i<this.length;i++)serializeToString(this[i],t,e,n);return t.join("")}};function LiveNodeList(e,n){this._node=e,this._refresh=n,_updateLiveList(this)}function _updateLiveList(e){var n=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=n){var t=e._refresh(e._node);__set__(e,"length",t.length),copy(t,e),e._inc=n}}LiveNodeList.prototype.item=function(e){return _updateLiveList(this),this[e]};_extends(LiveNodeList,NodeList);function NamedNodeMap(){}function _findNodeIndex(e,n){for(var t=e.length;t--;)if(e[t]===n)return t}function _addNamedNode(e,n,t,i){if(i?n[_findNodeIndex(n,i)]=t:n[n.length++]=t,e){t.ownerElement=e;var o=e.ownerDocument;o&&(i&&_onRemoveAttribute(o,e,i),_onAddAttribute(o,e,t))}}function _removeNamedNode(e,n,t){var i=_findNodeIndex(n,t);if(i>=0){for(var o=n.length-1;i<o;)n[i]=n[++i];if(n.length=o,e){var r=e.ownerDocument;r&&(_onRemoveAttribute(r,e,t),t.ownerElement=null)}}else throw DOMException(NOT_FOUND_ERR,new Error(e.tagName+"@"+t))}NamedNodeMap.prototype={length:0,item:NodeList.prototype.item,getNamedItem:function(e){for(var n=this.length;n--;){var t=this[n];if(t.nodeName==e)return t}},setNamedItem:function(e){var n=e.ownerElement;if(n&&n!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);var t=this.getNamedItem(e.nodeName);return _addNamedNode(this._ownerElement,this,e,t),t},setNamedItemNS:function(e){var n=e.ownerElement,t;if(n&&n!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);return t=this.getNamedItemNS(e.namespaceURI,e.localName),_addNamedNode(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var n=this.getNamedItem(e);return _removeNamedNode(this._ownerElement,this,n),n},removeNamedItemNS:function(e,n){var t=this.getNamedItemNS(e,n);return _removeNamedNode(this._ownerElement,this,t),t},getNamedItemNS:function(e,n){for(var t=this.length;t--;){var i=this[t];if(i.localName==n&&i.namespaceURI==e)return i}return null}};function DOMImplementation$1(){}DOMImplementation$1.prototype={hasFeature:function(e,n){return!0},createDocument:function(e,n,t){var i=new Document;if(i.implementation=this,i.childNodes=new NodeList,i.doctype=t||null,t&&i.appendChild(t),n){var o=i.createElementNS(e,n);i.appendChild(o)}return i},createDocumentType:function(e,n,t){var i=new DocumentType;return i.name=e,i.nodeName=e,i.publicId=n||"",i.systemId=t||"",i}};function Node(){}Node.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,n){return _insertBefore(this,e,n)},replaceChild:function(e,n){this.insertBefore(e,n),n&&this.removeChild(n)},removeChild:function(e){return _removeChild(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(e){return cloneNode(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var n=e.nextSibling;n&&n.nodeType==TEXT_NODE&&e.nodeType==TEXT_NODE?(this.removeChild(n),e.appendData(n.data)):(e.normalize(),e=n)}},isSupported:function(e,n){return this.ownerDocument.implementation.hasFeature(e,n)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var n=this;n;){var t=n._nsMap;if(t){for(var i in t)if(t[i]==e)return i}n=n.nodeType==ATTRIBUTE_NODE?n.ownerDocument:n.parentNode}return null},lookupNamespaceURI:function(e){for(var n=this;n;){var t=n._nsMap;if(t&&e in t)return t[e];n=n.nodeType==ATTRIBUTE_NODE?n.ownerDocument:n.parentNode}return null},isDefaultNamespace:function(e){var n=this.lookupPrefix(e);return n==null}};function _xmlEncoder(e){return e=="<"&&"&lt;"||e==">"&&"&gt;"||e=="&"&&"&amp;"||e=='"'&&"&quot;"||"&#"+e.charCodeAt()+";"}copy(NodeType,Node);copy(NodeType,Node.prototype);function _visitNode(e,n){if(n(e))return!0;if(e=e.firstChild)do if(_visitNode(e,n))return!0;while(e=e.nextSibling)}function Document(){}function _onAddAttribute(e,n,t){e&&e._inc++;var i=t.namespaceURI;i===NAMESPACE$2.XMLNS&&(n._nsMap[t.prefix?t.localName:""]=t.value)}function _onRemoveAttribute(e,n,t,i){e&&e._inc++;var o=t.namespaceURI;o===NAMESPACE$2.XMLNS&&delete n._nsMap[t.prefix?t.localName:""]}function _onUpdateChild(e,n,t){if(e&&e._inc){e._inc++;var i=n.childNodes;if(t)i[i.length++]=t;else{for(var o=n.firstChild,r=0;o;)i[r++]=o,o=o.nextSibling;i.length=r,delete i[i.length]}}}function _removeChild(e,n){var t=n.previousSibling,i=n.nextSibling;return t?t.nextSibling=i:e.firstChild=i,i?i.previousSibling=t:e.lastChild=t,n.parentNode=null,n.previousSibling=null,n.nextSibling=null,_onUpdateChild(e.ownerDocument,e),n}function _insertBefore(e,n,t){var i=n.parentNode;if(i&&i.removeChild(n),n.nodeType===DOCUMENT_FRAGMENT_NODE){var o=n.firstChild;if(o==null)return n;var r=n.lastChild}else o=r=n;var s=t?t.previousSibling:e.lastChild;o.previousSibling=s,r.nextSibling=t,s?s.nextSibling=o:e.firstChild=o,t==null?e.lastChild=r:t.previousSibling=r;do o.parentNode=e;while(o!==r&&(o=o.nextSibling));return _onUpdateChild(e.ownerDocument||e,e),n.nodeType==DOCUMENT_FRAGMENT_NODE&&(n.firstChild=n.lastChild=null),n}function _appendSingleChild(e,n){return n.parentNode&&n.parentNode.removeChild(n),n.parentNode=e,n.previousSibling=e.lastChild,n.nextSibling=null,n.previousSibling?n.previousSibling.nextSibling=n:e.firstChild=n,e.lastChild=n,_onUpdateChild(e.ownerDocument,e,n),n}Document.prototype={nodeName:"#document",nodeType:DOCUMENT_NODE,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,n){if(e.nodeType==DOCUMENT_FRAGMENT_NODE){for(var t=e.firstChild;t;){var i=t.nextSibling;this.insertBefore(t,n),t=i}return e}return this.documentElement==null&&e.nodeType==ELEMENT_NODE&&(this.documentElement=e),_insertBefore(this,e,n),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),_removeChild(this,e)},importNode:function(e,n){return importNode(this,e,n)},getElementById:function(e){var n=null;return _visitNode(this.documentElement,function(t){if(t.nodeType==ELEMENT_NODE&&t.getAttribute("id")==e)return n=t,!0}),n},getElementsByClassName:function(e){var n=toOrderedSet(e);return new LiveNodeList(this,function(t){var i=[];return n.length>0&&_visitNode(t.documentElement,function(o){if(o!==t&&o.nodeType===ELEMENT_NODE){var r=o.getAttribute("class");if(r){var s=e===r;if(!s){var u=toOrderedSet(r);s=n.every(arrayIncludes(u))}s&&i.push(o)}}}),i})},createElement:function(e){var n=new Element;n.ownerDocument=this,n.nodeName=e,n.tagName=e,n.localName=e,n.childNodes=new NodeList;var t=n.attributes=new NamedNodeMap;return t._ownerElement=n,n},createDocumentFragment:function(){var e=new DocumentFragment;return e.ownerDocument=this,e.childNodes=new NodeList,e},createTextNode:function(e){var n=new Text;return n.ownerDocument=this,n.appendData(e),n},createComment:function(e){var n=new Comment;return n.ownerDocument=this,n.appendData(e),n},createCDATASection:function(e){var n=new CDATASection;return n.ownerDocument=this,n.appendData(e),n},createProcessingInstruction:function(e,n){var t=new ProcessingInstruction;return t.ownerDocument=this,t.tagName=t.target=e,t.nodeValue=t.data=n,t},createAttribute:function(e){var n=new Attr;return n.ownerDocument=this,n.name=e,n.nodeName=e,n.localName=e,n.specified=!0,n},createEntityReference:function(e){var n=new EntityReference;return n.ownerDocument=this,n.nodeName=e,n},createElementNS:function(e,n){var t=new Element,i=n.split(":"),o=t.attributes=new NamedNodeMap;return t.childNodes=new NodeList,t.ownerDocument=this,t.nodeName=n,t.tagName=n,t.namespaceURI=e,i.length==2?(t.prefix=i[0],t.localName=i[1]):t.localName=n,o._ownerElement=t,t},createAttributeNS:function(e,n){var t=new Attr,i=n.split(":");return t.ownerDocument=this,t.nodeName=n,t.name=n,t.namespaceURI=e,t.specified=!0,i.length==2?(t.prefix=i[0],t.localName=i[1]):t.localName=n,t}};_extends(Document,Node);function Element(){this._nsMap={}}Element.prototype={nodeType:ELEMENT_NODE,hasAttribute:function(e){return this.getAttributeNode(e)!=null},getAttribute:function(e){var n=this.getAttributeNode(e);return n&&n.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,n){var t=this.ownerDocument.createAttribute(e);t.value=t.nodeValue=""+n,this.setAttributeNode(t)},removeAttribute:function(e){var n=this.getAttributeNode(e);n&&this.removeAttributeNode(n)},appendChild:function(e){return e.nodeType===DOCUMENT_FRAGMENT_NODE?this.insertBefore(e,null):_appendSingleChild(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,n){var t=this.getAttributeNodeNS(e,n);t&&this.removeAttributeNode(t)},hasAttributeNS:function(e,n){return this.getAttributeNodeNS(e,n)!=null},getAttributeNS:function(e,n){var t=this.getAttributeNodeNS(e,n);return t&&t.value||""},setAttributeNS:function(e,n,t){var i=this.ownerDocument.createAttributeNS(e,n);i.value=i.nodeValue=""+t,this.setAttributeNode(i)},getAttributeNodeNS:function(e,n){return this.attributes.getNamedItemNS(e,n)},getElementsByTagName:function(e){return new LiveNodeList(this,function(n){var t=[];return _visitNode(n,function(i){i!==n&&i.nodeType==ELEMENT_NODE&&(e==="*"||i.tagName==e)&&t.push(i)}),t})},getElementsByTagNameNS:function(e,n){return new LiveNodeList(this,function(t){var i=[];return _visitNode(t,function(o){o!==t&&o.nodeType===ELEMENT_NODE&&(e==="*"||o.namespaceURI===e)&&(n==="*"||o.localName==n)&&i.push(o)}),i})}};Document.prototype.getElementsByTagName=Element.prototype.getElementsByTagName;Document.prototype.getElementsByTagNameNS=Element.prototype.getElementsByTagNameNS;_extends(Element,Node);function Attr(){}Attr.prototype.nodeType=ATTRIBUTE_NODE;_extends(Attr,Node);function CharacterData(){}CharacterData.prototype={data:"",substringData:function(e,n){return this.data.substring(e,e+n)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,n){this.replaceData(e,0,n)},appendChild:function(e){throw new Error(ExceptionMessage[HIERARCHY_REQUEST_ERR])},deleteData:function(e,n){this.replaceData(e,n,"")},replaceData:function(e,n,t){var i=this.data.substring(0,e),o=this.data.substring(e+n);t=i+t+o,this.nodeValue=this.data=t,this.length=t.length}};_extends(CharacterData,Node);function Text(){}Text.prototype={nodeName:"#text",nodeType:TEXT_NODE,splitText:function(e){var n=this.data,t=n.substring(e);n=n.substring(0,e),this.data=this.nodeValue=n,this.length=n.length;var i=this.ownerDocument.createTextNode(t);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}};_extends(Text,CharacterData);function Comment(){}Comment.prototype={nodeName:"#comment",nodeType:COMMENT_NODE};_extends(Comment,CharacterData);function CDATASection(){}CDATASection.prototype={nodeName:"#cdata-section",nodeType:CDATA_SECTION_NODE};_extends(CDATASection,CharacterData);function DocumentType(){}DocumentType.prototype.nodeType=DOCUMENT_TYPE_NODE;_extends(DocumentType,Node);function Notation(){}Notation.prototype.nodeType=NOTATION_NODE;_extends(Notation,Node);function Entity(){}Entity.prototype.nodeType=ENTITY_NODE;_extends(Entity,Node);function EntityReference(){}EntityReference.prototype.nodeType=ENTITY_REFERENCE_NODE;_extends(EntityReference,Node);function DocumentFragment(){}DocumentFragment.prototype.nodeName="#document-fragment";DocumentFragment.prototype.nodeType=DOCUMENT_FRAGMENT_NODE;_extends(DocumentFragment,Node);function ProcessingInstruction(){}ProcessingInstruction.prototype.nodeType=PROCESSING_INSTRUCTION_NODE;_extends(ProcessingInstruction,Node);function XMLSerializer$1(){}XMLSerializer$1.prototype.serializeToString=function(e,n,t){return nodeSerializeToString.call(e,n,t)};Node.prototype.toString=nodeSerializeToString;function nodeSerializeToString(e,n){var t=[],i=this.nodeType==9&&this.documentElement||this,o=i.prefix,r=i.namespaceURI;if(r&&o==null){var o=i.lookupPrefix(r);if(o==null)var s=[{namespace:r,prefix:null}]}return serializeToString(this,t,e,n,s),t.join("")}function needNamespaceDefine(e,n,t){var i=e.prefix||"",o=e.namespaceURI;if(!o||i==="xml"&&o===NAMESPACE$2.XML||o===NAMESPACE$2.XMLNS)return!1;for(var r=t.length;r--;){var s=t[r];if(s.prefix===i)return s.namespace!==o}return!0}function addSerializedAttribute(e,n,t){e.push(" ",n,'="',t.replace(/[<>&"\t\n\r]/g,_xmlEncoder),'"')}function serializeToString(e,n,t,i,o){if(o||(o=[]),i)if(e=i(e),e){if(typeof e=="string"){n.push(e);return}}else return;switch(e.nodeType){case ELEMENT_NODE:var r=e.attributes,s=r.length,C=e.firstChild,u=e.tagName;t=NAMESPACE$2.isHTML(e.namespaceURI)||t;var c=u;if(!t&&!e.prefix&&e.namespaceURI){for(var f,l=0;l<r.length;l++)if(r.item(l).name==="xmlns"){f=r.item(l).value;break}if(!f)for(var a=o.length-1;a>=0;a--){var d=o[a];if(d.prefix===""&&d.namespace===e.namespaceURI){f=d.namespace;break}}if(f!==e.namespaceURI)for(var a=o.length-1;a>=0;a--){var d=o[a];if(d.namespace===e.namespaceURI){d.prefix&&(c=d.prefix+":"+u);break}}}n.push("<",c);for(var y=0;y<s;y++){var R=r.item(y);R.prefix=="xmlns"?o.push({prefix:R.localName,namespace:R.value}):R.nodeName=="xmlns"&&o.push({prefix:"",namespace:R.value})}for(var y=0;y<s;y++){var R=r.item(y);if(needNamespaceDefine(R,t,o)){var g=R.prefix||"",h=R.namespaceURI;addSerializedAttribute(n,g?"xmlns:"+g:"xmlns",h),o.push({prefix:g,namespace:h})}serializeToString(R,n,t,i,o)}if(u===c&&needNamespaceDefine(e,t,o)){var g=e.prefix||"",h=e.namespaceURI;addSerializedAttribute(n,g?"xmlns:"+g:"xmlns",h),o.push({prefix:g,namespace:h})}if(C||t&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){if(n.push(">"),t&&/^script$/i.test(u))for(;C;)C.data?n.push(C.data):serializeToString(C,n,t,i,o.slice()),C=C.nextSibling;else for(;C;)serializeToString(C,n,t,i,o.slice()),C=C.nextSibling;n.push("</",c,">")}else n.push("/>");return;case DOCUMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(var C=e.firstChild;C;)serializeToString(C,n,t,i,o.slice()),C=C.nextSibling;return;case ATTRIBUTE_NODE:return addSerializedAttribute(n,e.name,e.value);case TEXT_NODE:return n.push(e.data.replace(/[<&>]/g,_xmlEncoder));case CDATA_SECTION_NODE:return n.push("<![CDATA[",e.data,"]]>");case COMMENT_NODE:return n.push("<!--",e.data,"-->");case DOCUMENT_TYPE_NODE:var p=e.publicId,v=e.systemId;if(n.push("<!DOCTYPE ",e.name),p)n.push(" PUBLIC ",p),v&&v!="."&&n.push(" ",v),n.push(">");else if(v&&v!=".")n.push(" SYSTEM ",v,">");else{var S=e.internalSubset;S&&n.push(" [",S,"]"),n.push(">")}return;case PROCESSING_INSTRUCTION_NODE:return n.push("<?",e.target," ",e.data,"?>");case ENTITY_REFERENCE_NODE:return n.push("&",e.nodeName,";");default:n.push("??",e.nodeName)}}function importNode(e,n,t){var i;switch(n.nodeType){case ELEMENT_NODE:i=n.cloneNode(!1),i.ownerDocument=e;case DOCUMENT_FRAGMENT_NODE:break;case ATTRIBUTE_NODE:t=!0;break}if(i||(i=n.cloneNode(!1)),i.ownerDocument=e,i.parentNode=null,t)for(var o=n.firstChild;o;)i.appendChild(importNode(e,o,t)),o=o.nextSibling;return i}function cloneNode(e,n,t){var i=new n.constructor;for(var o in n){var r=n[o];typeof r!="object"&&r!=i[o]&&(i[o]=r)}switch(n.childNodes&&(i.childNodes=new NodeList),i.ownerDocument=e,i.nodeType){case ELEMENT_NODE:var s=n.attributes,u=i.attributes=new NamedNodeMap,c=s.length;u._ownerElement=i;for(var f=0;f<c;f++)i.setAttributeNode(cloneNode(e,s.item(f),!0));break;case ATTRIBUTE_NODE:t=!0}if(t)for(var l=n.firstChild;l;)i.appendChild(cloneNode(e,l,t)),l=l.nextSibling;return i}function __set__(e,n,t){e[n]=t}try{if(Object.defineProperty){let e=function(n){switch(n.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:var t=[];for(n=n.firstChild;n;)n.nodeType!==7&&n.nodeType!==8&&t.push(e(n)),n=n.nextSibling;return t.join("");default:return n.nodeValue}};Object.defineProperty(LiveNodeList.prototype,"length",{get:function(){return _updateLiveList(this),this.$$length}}),Object.defineProperty(Node.prototype,"textContent",{get:function(){return e(this)},set:function(n){switch(this.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(;this.firstChild;)this.removeChild(this.firstChild);(n||String(n))&&this.appendChild(this.ownerDocument.createTextNode(n));break;default:this.data=n,this.value=n,this.nodeValue=n}}}),__set__=function(n,t,i){n["$$"+t]=i}}}catch(e){}dom$2.DocumentType=DocumentType;dom$2.DOMException=DOMException;dom$2.DOMImplementation=DOMImplementation$1;dom$2.Element=Element;dom$2.Node=Node;dom$2.NodeList=NodeList;dom$2.XMLSerializer=XMLSerializer$1;var domParser={},entities$1={};(function(e){var n=conventions$2.freeze;e.XML_ENTITIES=n({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),e.HTML_ENTITIES=n({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"\xC0",Aacute:"\xC1",Acirc:"\xC2",Atilde:"\xC3",Auml:"\xC4",Aring:"\xC5",AElig:"\xC6",Ccedil:"\xC7",Egrave:"\xC8",Eacute:"\xC9",Ecirc:"\xCA",Euml:"\xCB",Igrave:"\xCC",Iacute:"\xCD",Icirc:"\xCE",Iuml:"\xCF",ETH:"\xD0",Ntilde:"\xD1",Ograve:"\xD2",Oacute:"\xD3",Ocirc:"\xD4",Otilde:"\xD5",Ouml:"\xD6",Oslash:"\xD8",Ugrave:"\xD9",Uacute:"\xDA",Ucirc:"\xDB",Uuml:"\xDC",Yacute:"\xDD",THORN:"\xDE",szlig:"\xDF",agrave:"\xE0",aacute:"\xE1",acirc:"\xE2",atilde:"\xE3",auml:"\xE4",aring:"\xE5",aelig:"\xE6",ccedil:"\xE7",egrave:"\xE8",eacute:"\xE9",ecirc:"\xEA",euml:"\xEB",igrave:"\xEC",iacute:"\xED",icirc:"\xEE",iuml:"\xEF",eth:"\xF0",ntilde:"\xF1",ograve:"\xF2",oacute:"\xF3",ocirc:"\xF4",otilde:"\xF5",ouml:"\xF6",oslash:"\xF8",ugrave:"\xF9",uacute:"\xFA",ucirc:"\xFB",uuml:"\xFC",yacute:"\xFD",thorn:"\xFE",yuml:"\xFF",nbsp:"\xA0",iexcl:"\xA1",cent:"\xA2",pound:"\xA3",curren:"\xA4",yen:"\xA5",brvbar:"\xA6",sect:"\xA7",uml:"\xA8",copy:"\xA9",ordf:"\xAA",laquo:"\xAB",not:"\xAC",shy:"\xAD\xAD",reg:"\xAE",macr:"\xAF",deg:"\xB0",plusmn:"\xB1",sup2:"\xB2",sup3:"\xB3",acute:"\xB4",micro:"\xB5",para:"\xB6",middot:"\xB7",cedil:"\xB8",sup1:"\xB9",ordm:"\xBA",raquo:"\xBB",frac14:"\xBC",frac12:"\xBD",frac34:"\xBE",iquest:"\xBF",times:"\xD7",divide:"\xF7",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220B",prod:"\u220F",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221A",prop:"\u221D",infin:"\u221E",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222A",int:"\u222B",there4:"\u2234",sim:"\u223C",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22A5",sdot:"\u22C5",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039A",Lambda:"\u039B",Mu:"\u039C",Nu:"\u039D",Xi:"\u039E",Omicron:"\u039F",Pi:"\u03A0",Rho:"\u03A1",Sigma:"\u03A3",Tau:"\u03A4",Upsilon:"\u03A5",Phi:"\u03A6",Chi:"\u03A7",Psi:"\u03A8",Omega:"\u03A9",alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u03B5",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",omicron:"\u03BF",pi:"\u03C0",rho:"\u03C1",sigmaf:"\u03C2",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",thetasym:"\u03D1",upsih:"\u03D2",piv:"\u03D6",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",fnof:"\u0192",circ:"\u02C6",tilde:"\u02DC",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200C",zwj:"\u200D",lrm:"\u200E",rlm:"\u200F",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201A",ldquo:"\u201C",rdquo:"\u201D",bdquo:"\u201E",dagger:"\u2020",Dagger:"\u2021",bull:"\u2022",hellip:"\u2026",permil:"\u2030",prime:"\u2032",Prime:"\u2033",lsaquo:"\u2039",rsaquo:"\u203A",oline:"\u203E",euro:"\u20AC",trade:"\u2122",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21B5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230A",rfloor:"\u230B",loz:"\u25CA",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666"}),e.entityMap=e.HTML_ENTITIES})(entities$1);var sax$1={},NAMESPACE$1=conventions$2.NAMESPACE,nameStartChar=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,nameChar=new RegExp("[\\-\\.0-9"+nameStartChar.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),tagNamePattern=new RegExp("^"+nameStartChar.source+nameChar.source+"*(?::"+nameStartChar.source+nameChar.source+"*)?$"),S_TAG=0,S_ATTR=1,S_ATTR_SPACE=2,S_EQ=3,S_ATTR_NOQUOT_VALUE=4,S_ATTR_END=5,S_TAG_SPACE=6,S_TAG_CLOSE=7;function ParseError$1(e,n){this.message=e,this.locator=n,Error.captureStackTrace&&Error.captureStackTrace(this,ParseError$1)}ParseError$1.prototype=new Error;ParseError$1.prototype.name=ParseError$1.name;function XMLReader$1(){}XMLReader$1.prototype={parse:function(e,n,t){var i=this.domBuilder;i.startDocument(),_copy(n,n={}),parse(e,n,t,i,this.errorHandler),i.endDocument()}};function parse(e,n,t,i,o){function r(B){if(B>65535){B-=65536;var O=55296+(B>>10),M=56320+(B&1023);return String.fromCharCode(O,M)}else return String.fromCharCode(B)}function s(B){var O=B.slice(1,-1);return Object.hasOwnProperty.call(t,O)?t[O]:O.charAt(0)==="#"?r(parseInt(O.substr(1).replace("x","0x"))):(o.error("entity not found:"+B),B)}function u(B){if(B>g){var O=e.substring(g,B).replace(/&#?\w+;/g,s);d&&c(g),i.characters(O,0,B-g),g=B}}function c(B,O){for(;B>=l&&(O=a.exec(e));)f=O.index,l=f+O[0].length,d.lineNumber++;d.columnNumber=B-f+1}for(var f=0,l=0,a=/.*(?:\r\n?|\n)|.*$/g,d=i.locator,y=[{currentNSMap:n}],R={},g=0;;){try{var h=e.indexOf("<",g);if(h<0){if(!e.substr(g).match(/^\s*$/)){var C=i.doc,p=C.createTextNode(e.substr(g));C.appendChild(p),i.currentElement=p}return}switch(h>g&&u(h),e.charAt(h+1)){case"/":var x=e.indexOf(">",h+3),v=e.substring(h+2,x).replace(/[ \t\n\r]+$/g,""),S=y.pop();x<0?(v=e.substring(h+2).replace(/[\s<].*/,""),o.error("end tag name: "+v+" is not complete:"+S.tagName),x=h+1+v.length):v.match(/\s</)&&(v=v.replace(/[\s<].*/,""),o.error("end tag name: "+v+" maybe not complete"),x=h+1+v.length);var E=S.localNSMap,T=S.tagName==v,m=T||S.tagName&&S.tagName.toLowerCase()==v.toLowerCase();if(m){if(i.endElement(S.uri,S.localName,v),E)for(var _ in E)i.endPrefixMapping(_);T||o.fatalError("end tag name: "+v+" is not match the current start tagName:"+S.tagName)}else y.push(S);x++;break;case"?":d&&c(h),x=parseInstruction(e,h,i);break;case"!":d&&c(h),x=parseDCC(e,h,i,o);break;default:d&&c(h);var A=new ElementAttributes,k=y[y.length-1].currentNSMap,x=parseElementStartPart(e,h,A,k,s,o),N=A.length;if(!A.closed&&fixSelfClosed(e,x,A.tagName,R)&&(A.closed=!0,t.nbsp||o.warning("unclosed xml attribute")),d&&N){for(var P=copyLocator(d,{}),I=0;I<N;I++){var D=A[I];c(D.offset),D.locator=copyLocator(d,{})}i.locator=P,appendElement$1(A,i,k)&&y.push(A),i.locator=d}else appendElement$1(A,i,k)&&y.push(A);NAMESPACE$1.isHTML(A.uri)&&!A.closed?x=parseHtmlSpecialContent(e,x,A.tagName,s,i):x++}}catch(B){if(B instanceof ParseError$1)throw B;o.error("element parse error: "+B),x=-1}x>g?g=x:u(Math.max(h,g)+1)}}function copyLocator(e,n){return n.lineNumber=e.lineNumber,n.columnNumber=e.columnNumber,n}function parseElementStartPart(e,n,t,i,o,r){function s(d,y,R){t.attributeNames.hasOwnProperty(d)&&r.fatalError("Attribute "+d+" redefined"),t.addValue(d,y.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,o),R)}for(var u,c,f=++n,l=S_TAG;;){var a=e.charAt(f);switch(a){case"=":if(l===S_ATTR)u=e.slice(n,f),l=S_EQ;else if(l===S_ATTR_SPACE)l=S_EQ;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(l===S_EQ||l===S_ATTR)if(l===S_ATTR&&(r.warning('attribute value must after "="'),u=e.slice(n,f)),n=f+1,f=e.indexOf(a,n),f>0)c=e.slice(n,f),s(u,c,n-1),l=S_ATTR_END;else throw new Error("attribute value no end '"+a+"' match");else if(l==S_ATTR_NOQUOT_VALUE)c=e.slice(n,f),s(u,c,n),r.warning('attribute "'+u+'" missed start quot('+a+")!!"),n=f+1,l=S_ATTR_END;else throw new Error('attribute value must after "="');break;case"/":switch(l){case S_TAG:t.setTagName(e.slice(n,f));case S_ATTR_END:case S_TAG_SPACE:case S_TAG_CLOSE:l=S_TAG_CLOSE,t.closed=!0;case S_ATTR_NOQUOT_VALUE:case S_ATTR:case S_ATTR_SPACE:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return r.error("unexpected end of input"),l==S_TAG&&t.setTagName(e.slice(n,f)),f;case">":switch(l){case S_TAG:t.setTagName(e.slice(n,f));case S_ATTR_END:case S_TAG_SPACE:case S_TAG_CLOSE:break;case S_ATTR_NOQUOT_VALUE:case S_ATTR:c=e.slice(n,f),c.slice(-1)==="/"&&(t.closed=!0,c=c.slice(0,-1));case S_ATTR_SPACE:l===S_ATTR_SPACE&&(c=u),l==S_ATTR_NOQUOT_VALUE?(r.warning('attribute "'+c+'" missed quot(")!'),s(u,c,n)):((!NAMESPACE$1.isHTML(i[""])||!c.match(/^(?:disabled|checked|selected)$/i))&&r.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),s(c,c,n));break;case S_EQ:throw new Error("attribute value missed!!")}return f;case"\x80":a=" ";default:if(a<=" ")switch(l){case S_TAG:t.setTagName(e.slice(n,f)),l=S_TAG_SPACE;break;case S_ATTR:u=e.slice(n,f),l=S_ATTR_SPACE;break;case S_ATTR_NOQUOT_VALUE:var c=e.slice(n,f);r.warning('attribute "'+c+'" missed quot(")!!'),s(u,c,n);case S_ATTR_END:l=S_TAG_SPACE;break}else switch(l){case S_ATTR_SPACE:t.tagName,(!NAMESPACE$1.isHTML(i[""])||!u.match(/^(?:disabled|checked|selected)$/i))&&r.warning('attribute "'+u+'" missed value!! "'+u+'" instead2!!'),s(u,u,n),n=f,l=S_ATTR;break;case S_ATTR_END:r.warning('attribute space is required"'+u+'"!!');case S_TAG_SPACE:l=S_ATTR,n=f;break;case S_EQ:l=S_ATTR_NOQUOT_VALUE,n=f;break;case S_TAG_CLOSE:throw new Error("elements closed character '/' and '>' must be connected to")}}f++}}function appendElement$1(e,n,t){for(var i=e.tagName,o=null,a=e.length;a--;){var r=e[a],s=r.qName,u=r.value,d=s.indexOf(":");if(d>0)var c=r.prefix=s.slice(0,d),f=s.slice(d+1),l=c==="xmlns"&&f;else f=s,c=null,l=s==="xmlns"&&"";r.localName=f,l!==!1&&(o==null&&(o={},_copy(t,t={})),t[l]=o[l]=u,r.uri=NAMESPACE$1.XMLNS,n.startPrefixMapping(l,u))}for(var a=e.length;a--;){r=e[a];var c=r.prefix;c&&(c==="xml"&&(r.uri=NAMESPACE$1.XML),c!=="xmlns"&&(r.uri=t[c||""]))}var d=i.indexOf(":");d>0?(c=e.prefix=i.slice(0,d),f=e.localName=i.slice(d+1)):(c=null,f=e.localName=i);var y=e.uri=t[c||""];if(n.startElement(y,f,i,e),e.closed){if(n.endElement(y,f,i),o)for(c in o)n.endPrefixMapping(c)}else return e.currentNSMap=t,e.localNSMap=o,!0}function parseHtmlSpecialContent(e,n,t,i,o){if(/^(?:script|textarea)$/i.test(t)){var r=e.indexOf("</"+t+">",n),s=e.substring(n+1,r);if(/[&<]/.test(s))return/^script$/i.test(t)?(o.characters(s,0,s.length),r):(s=s.replace(/&#?\w+;/g,i),o.characters(s,0,s.length),r)}return n+1}function fixSelfClosed(e,n,t,i){var o=i[t];return o==null&&(o=e.lastIndexOf("</"+t+">"),o<n&&(o=e.lastIndexOf("</"+t)),i[t]=o),o<n}function _copy(e,n){for(var t in e)n[t]=e[t]}function parseDCC(e,n,t,i){var o=e.charAt(n+2);switch(o){case"-":if(e.charAt(n+3)==="-"){var r=e.indexOf("-->",n+4);return r>n?(t.comment(e,n+4,r-n-4),r+3):(i.error("Unclosed comment"),-1)}else return-1;default:if(e.substr(n+3,6)=="CDATA["){var r=e.indexOf("]]>",n+9);return t.startCDATA(),t.characters(e,n+9,r-n-9),t.endCDATA(),r+3}var s=split(e,n),u=s.length;if(u>1&&/!doctype/i.test(s[0][0])){var c=s[1][0],f=!1,l=!1;u>3&&(/^public$/i.test(s[2][0])?(f=s[3][0],l=u>4&&s[4][0]):/^system$/i.test(s[2][0])&&(l=s[3][0]));var a=s[u-1];return t.startDTD(c,f,l),t.endDTD(),a.index+a[0].length}}return-1}function parseInstruction(e,n,t){var i=e.indexOf("?>",n);if(i){var o=e.substring(n,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return o?(o[0].length,t.processingInstruction(o[1],o[2]),i+2):-1}return-1}function ElementAttributes(){this.attributeNames={}}ElementAttributes.prototype={setTagName:function(e){if(!tagNamePattern.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,n,t){if(!tagNamePattern.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:n,offset:t}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}};function split(e,n){var t,i=[],o=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(o.lastIndex=n,o.exec(e);t=o.exec(e);)if(i.push(t),t[1])return i}sax$1.XMLReader=XMLReader$1;sax$1.ParseError=ParseError$1;var conventions=conventions$2,dom$1=dom$2,entities=entities$1,sax=sax$1,DOMImplementation=dom$1.DOMImplementation,NAMESPACE=conventions.NAMESPACE,ParseError=sax.ParseError,XMLReader=sax.XMLReader;function normalizeLineEndings(e){return e.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function DOMParser$1(e){this.options=e||{locator:{}}}DOMParser$1.prototype.parseFromString=function(e,n){var t=this.options,i=new XMLReader,o=t.domBuilder||new DOMHandler,r=t.errorHandler,s=t.locator,u=t.xmlns||{},c=/\/x?html?$/.test(n),f=c?entities.HTML_ENTITIES:entities.XML_ENTITIES;s&&o.setDocumentLocator(s),i.errorHandler=buildErrorHandler(r,o,s),i.domBuilder=t.domBuilder||o,c&&(u[""]=NAMESPACE.HTML),u.xml=u.xml||NAMESPACE.XML;var l=t.normalizeLineEndings||normalizeLineEndings;return e&&typeof e=="string"?i.parse(l(e),u,f):i.errorHandler.error("invalid doc source"),o.doc};function buildErrorHandler(e,n,t){if(!e){if(n instanceof DOMHandler)return n;e=n}var i={},o=e instanceof Function;t=t||{};function r(s){var u=e[s];!u&&o&&(u=e.length==2?function(c){e(s,c)}:e),i[s]=u&&function(c){u("[xmldom "+s+"]	"+c+_locator(t))}||function(){}}return r("warning"),r("error"),r("fatalError"),i}function DOMHandler(){this.cdata=!1}function position(e,n){n.lineNumber=e.lineNumber,n.columnNumber=e.columnNumber}DOMHandler.prototype={startDocument:function(){this.doc=new DOMImplementation().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,n,t,i){var o=this.doc,r=o.createElementNS(e,t||n),s=i.length;appendElement(this,r),this.currentElement=r,this.locator&&position(this.locator,r);for(var u=0;u<s;u++){var e=i.getURI(u),c=i.getValue(u),t=i.getQName(u),f=o.createAttributeNS(e,t);this.locator&&position(i.getLocator(u),f),f.value=f.nodeValue=c,r.setAttributeNode(f)}},endElement:function(e,n,t){var i=this.currentElement;i.tagName,this.currentElement=i.parentNode},startPrefixMapping:function(e,n){},endPrefixMapping:function(e){},processingInstruction:function(e,n){var t=this.doc.createProcessingInstruction(e,n);this.locator&&position(this.locator,t),appendElement(this,t)},ignorableWhitespace:function(e,n,t){},characters:function(e,n,t){if(e=_toString.apply(this,arguments),e){if(this.cdata)var i=this.doc.createCDATASection(e);else var i=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(i):/^\s*$/.test(e)&&this.doc.appendChild(i),this.locator&&position(this.locator,i)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,n,t){e=_toString.apply(this,arguments);var i=this.doc.createComment(e);this.locator&&position(this.locator,i),appendElement(this,i)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,n,t){var i=this.doc.implementation;if(i&&i.createDocumentType){var o=i.createDocumentType(e,n,t);this.locator&&position(this.locator,o),appendElement(this,o),this.doc.doctype=o}},warning:function(e){console.warn("[xmldom warning]	"+e,_locator(this.locator))},error:function(e){console.error("[xmldom error]	"+e,_locator(this.locator))},fatalError:function(e){throw new ParseError(e,this.locator)}};function _locator(e){if(e)return`
@`+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function _toString(e,n,t){return typeof e=="string"?e.substr(n,t):e.length>=n+t||n?new java.lang.String(e,n,t)+"":e}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){DOMHandler.prototype[e]=function(){return null}});function appendElement(e,n){e.currentElement?e.currentElement.appendChild(n):e.doc.appendChild(n)}domParser.__DOMHandler=DOMHandler;domParser.normalizeLineEndings=normalizeLineEndings;domParser.DOMParser=DOMParser$1;var dom=dom$2;lib.DOMImplementation=dom.DOMImplementation;lib.XMLSerializer=dom.XMLSerializer;lib.DOMParser=domParser.DOMParser;var DOMParser=lib.DOMParser,xmlToJSON=function(){this.version="1.3.5";var e={mergeCDATA:!0,normalize:!0,stripElemPrefix:!0},n=new RegExp(/(?!xmlns)^.*:/);return this.grokType=function(t){return/^\s*$/.test(t)?null:/^(?:true|false)$/i.test(t)?t.toLowerCase()==="true":isFinite(t)?parseFloat(t):t},this.parseString=function(t,i){if(t){var o=this.stringToXML(t);return o.getElementsByTagName("parsererror").length?null:this.parseXML(o,i)}else return null},this.parseXML=function(t,i){for(var o in i)e[o]=i[o];var r={},s=0,u="",c=t.childNodes.length;if(c)for(var f,l,a,d=0;d<t.childNodes.length;d++)f=t.childNodes.item(d),f.nodeType===4?e.mergeCDATA&&(u+=f.nodeValue):f.nodeType===3?u+=f.nodeValue:f.nodeType===1&&(s===0&&(r={}),e.stripElemPrefix?l=f.nodeName.replace(n,""):l=f.nodeName,a=xmlToJSON.parseXML(f),r.hasOwnProperty(l)?(r[l].constructor!==Array&&(r[l]=[r[l]]),r[l].push(a)):(r[l]=a,s++));return Object.keys(r).length||(r=u||""),r},this.xmlToString=function(t){try{var i=t.xml?t.xml:new XMLSerializer().serializeToString(t);return i}catch{return null}},this.stringToXML=function(t){try{var i=null;if(window.DOMParser){var o=new DOMParser;return i=o.parseFromString(t,"text/xml"),i}else return i=new ActiveXObject("Microsoft.XMLDOM"),i.async=!1,i.loadXML(t),i}catch{return null}},this}.call({}),xml2json$1=function(e){return xmlToJSON.parseString(e)},xml2json_1=xml2json$1,element_start_char="a-zA-Z_\xC0-\xD6\xD8-\xF6\xF8-\xFF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FFF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD",element_non_start_char="-.0-9\xB7\u0300-\u036F\u203F\u2040",element_replace=new RegExp("^([^"+element_start_char+"])|^((x|X)(m|M)(l|L))|([^"+element_start_char+element_non_start_char+"])","g"),not_safe_in_xml=/[^\x09\x0A\x0D\x20-\xFF\x85\xA0-\uD7FF\uE000-\uFDCF\uFDE0-\uFFFD]/gm,objKeys=function(e){var n=[];if(e instanceof Object)for(var t in e)e.hasOwnProperty(t)&&n.push(t);return n},process_to_xml=function(e,n){var t=function(i,o,r,s,u){var c=n.indent!==void 0?n.indent:"	",f=n.prettyPrint?`
`+new Array(s).join(c):"";n.removeIllegalNameCharacters&&(i=i.replace(element_replace,"_"));var l=[f,"<",i,r||""];return o&&o.length>0?(l.push(">"),l.push(o),u&&l.push(f),l.push("</"),l.push(i),l.push(">")):l.push("/>"),l.join("")};return function i(o,r,s){var u=typeof o;switch((Array.isArray?Array.isArray(o):o instanceof Array)?u="array":o instanceof Date&&(u="date"),u){case"array":var c=[];return o.map(function(d){c.push(i(d,1,s+1))}),n.prettyPrint&&c.push(`
`),c.join("");case"date":return o.toJSON?o.toJSON():o+"";case"object":var f=[];for(var l in o)if(o.hasOwnProperty(l))if(o[l]instanceof Array)for(var a=0;a<o[l].length;a++)o[l].hasOwnProperty(a)&&f.push(t(l,i(o[l][a],0,s+1),null,s+1,objKeys(o[l][a]).length));else f.push(t(l,i(o[l],0,s+1),null,s+1));return n.prettyPrint&&f.length>0&&f.push(`
`),f.join("");case"function":return o();default:return n.escape?esc(o):""+o}}(e,0,0)},xml_header=function(e){var n=['<?xml version="1.0" encoding="UTF-8"'];return e&&n.push(' standalone="yes"'),n.push("?>"),n.join("")};function esc(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(not_safe_in_xml,"")}var json2xml$1=function(e,n){if(n||(n={xmlHeader:{standalone:!0},prettyPrint:!0,indent:"  ",escape:!0}),typeof e=="string")try{e=JSON.parse(e.toString())}catch{return!1}var t="",i="";n&&(typeof n=="object"?(n.xmlHeader&&(t=xml_header(!!n.xmlHeader.standalone)),typeof n.docType!="undefined"&&(i="<!DOCTYPE "+n.docType+">")):t=xml_header()),n=n||{};var o=[t,n.prettyPrint&&i?`
`:"",i,process_to_xml(e,n)];return o.join("").replace(/\n{2,}/g,`
`).replace(/\s+$/g,"")},md5=md5$1.exports,CryptoJS=crypto.exports,xml2json=xml2json_1,json2xml=json2xml$1;function camSafeUrlEncode(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function getObjectKeys(e,n){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(n?camSafeUrlEncode(i).toLowerCase():i);return t.sort(function(o,r){return o=o.toLowerCase(),r=r.toLowerCase(),o===r?0:o>r?1:-1})}var obj2str=function(e,n){var t,i,o,r=[],s=getObjectKeys(e);for(t=0;t<s.length;t++)i=s[t],o=e[i]===void 0||e[i]===null?"":""+e[i],i=n?camSafeUrlEncode(i).toLowerCase():camSafeUrlEncode(i),o=camSafeUrlEncode(o)||"",r.push(i+"="+o);return r.join("&")},signHeaders=["content-disposition","content-encoding","content-length","content-md5","expect","host","if-match","if-modified-since","if-none-match","if-unmodified-since","origin","range","response-cache-control","response-content-disposition","response-content-encoding","response-content-language","response-content-type","response-expires","transfer-encoding","versionid"],getSignHeaderObj=function(e){var n={};for(var t in e){var i=t.toLowerCase();(i.indexOf("x-cos-")>-1||signHeaders.indexOf(i)>-1)&&(n[t]=e[t])}return n},getAuth$1=function(e){e=e||{};var n=e.SecretId,t=e.SecretKey,i=e.KeyTime,o=(e.method||e.Method||"get").toLowerCase(),r=clone(e.Query||e.params||{}),s=getSignHeaderObj(clone(e.Headers||e.headers||{})),u=e.Key||"",c;e.UseRawKey?c=e.Pathname||e.pathname||"/"+u:(c=e.Pathname||e.pathname||u,c.indexOf("/")!==0&&(c="/"+c));var f=e.ForceSignHost!==!1;if(!s.Host&&!s.host&&e.Bucket&&e.Region&&f&&(s.Host=e.Bucket+".cos."+e.Region+".myqcloud.com"),!n)throw new Error("missing param SecretId");if(!t)throw new Error("missing param SecretKey");var l=Math.round(getSkewTime(e.SystemClockOffset)/1e3)-1,a=l,d=e.Expires||e.expires;d===void 0?a+=900:a+=d*1||0;var y="sha1",R=n,g=i||l+";"+a,h=i||l+";"+a,C=getObjectKeys(s,!0).join(";").toLowerCase(),p=getObjectKeys(r,!0).join(";").toLowerCase(),v=CryptoJS.HmacSHA1(h,t).toString(),S=[o,c,util$5.obj2str(r,!0),util$5.obj2str(s,!0),""].join(`
`),E=["sha1",g,CryptoJS.SHA1(S).toString(),""].join(`
`),T=CryptoJS.HmacSHA1(E,v).toString(),m=["q-sign-algorithm="+y,"q-ak="+R,"q-sign-time="+g,"q-key-time="+h,"q-header-list="+C,"q-url-param-list="+p,"q-signature="+T].join("&");return m},readIntBE=function(e,n,t){var i=n/8,o=e.slice(t,t+i);return new Uint8Array(o).reverse(),new{8:Uint8Array,16:Uint16Array,32:Uint32Array}[n](o)[0]},buf2str=function(e,n,t,i){var o=e.slice(n,t),r="";return new Uint8Array(o).forEach(function(s){r+=String.fromCharCode(s)}),i&&(r=decodeURIComponent(escape(r))),r},parseSelectPayload=function(e){for(var n={},t=buf2str(e),i={records:[]};e.byteLength;){var o=readIntBE(e,32,0),r=readIntBE(e,32,4),s=o-r-16,u=0,c;for(e=e.slice(12);u<r;){var f=readIntBE(e,8,u),l=buf2str(e,u+1,u+1+f),a=readIntBE(e,16,u+f+2),d=buf2str(e,u+f+4,u+f+4+a);n[l]=d,u+=f+4+a}if(n[":event-type"]==="Records")c=buf2str(e,u,u+s,!0),i.records.push(c);else if(n[":event-type"]==="Stats")c=buf2str(e,u,u+s,!0),i.stats=util$5.xml2json(c).Stats;else if(n[":event-type"]==="error"){var y=n[":error-code"],R=n[":error-message"],g=new Error(R);g.message=R,g.name=g.code=y,i.error=g}e=e.slice(u+s+4)}return{payload:i.records.join(""),body:t}},getSourceParams=function(e){var n=this.options.CopySourceParser;if(n)return n(e);var t=e.match(/^([^.]+-\d+)\.cos(v6|-cdc)?\.([^.]+)\.myqcloud\.com\/(.+)$/);return t?{Bucket:t[1],Region:t[3],Key:t[4]}:null},noop=function(){},clearKey=function(e){var n={};for(var t in e)e.hasOwnProperty(t)&&e[t]!==void 0&&e[t]!==null&&(n[t]=e[t]);return n},readAsBinaryString=function(e,n){var t,i=new FileReader;FileReader.prototype.readAsBinaryString?(t=FileReader.prototype.readAsBinaryString,i.onload=function(){n(this.result)}):FileReader.prototype.readAsArrayBuffer?t=function(o){var r="",s=new FileReader;s.onload=function(u){for(var c=new Uint8Array(s.result),f=c.byteLength,l=0;l<f;l++)r+=String.fromCharCode(c[l]);n(r)},s.readAsArrayBuffer(o)}:console.error("FileReader not support readAsBinaryString"),t.call(i,e)},fileSliceNeedCopy=function(){var e=function(t,i){t=t.split("."),i=i.split(".");for(var o=0;o<i.length;o++)if(t[o]!==i[o])return parseInt(t[o])>parseInt(i[o])?1:-1;return 0},n=function(t){if(!t)return!1;var i=(t.match(/Chrome\/([.\d]+)/)||[])[1],o=(t.match(/QBCore\/([.\d]+)/)||[])[1],r=(t.match(/QQBrowser\/([.\d]+)/)||[])[1],s=i&&e(i,"53.0.2785.116")<0&&o&&e(o,"3.53.991.400")<0&&r&&e(r,"9.0.2524.400")<=0||!1;return s};return n(typeof navigator!="undefined"&&navigator.userAgent)}(),fileSlice=function(e,n,t,i,o){var r;if(e.slice?r=e.slice(n,t):e.mozSlice?r=e.mozSlice(n,t):e.webkitSlice&&(r=e.webkitSlice(n,t)),i&&fileSliceNeedCopy){var s=new FileReader;s.onload=function(u){r=null,o(new Blob([s.result]))},s.readAsArrayBuffer(r)}else o(r)},getBodyMd5=function(e,n,t,i){t=t||noop,e?typeof n=="string"?t(util$5.md5(n,!0)):Blob&&n instanceof Blob?util$5.getFileMd5(n,function(o,r){t(r)},i):t():t()},md5ChunkSize=1024*1024,getFileMd5=function(e,n,t){var i=e.size,o=0,r=md5.getCtx(),s=function(u){if(u>=i){var c=r.digest("hex");n(null,c);return}var f=Math.min(i,u+md5ChunkSize);util$5.fileSlice(e,u,f,!1,function(l){readAsBinaryString(l,function(a){l=null,r=r.update(a,!0),o+=a.length,a=null,t&&t({loaded:o,total:i,percent:Math.round(o/i*1e4)/1e4}),s(u+md5ChunkSize)})})};s(0)};function clone(e){return map(e,function(n){return typeof n=="object"&&n!==null?clone(n):n})}function attr(e,n,t){return e&&n in e?e[n]:t}function extend(e,n){return each(n,function(t,i){e[i]=n[i]}),e}function isArray(e){return e instanceof Array}function isInArray(e,n){for(var t=!1,i=0;i<e.length;i++)if(n===e[i]){t=!0;break}return t}function makeArray(e){return isArray(e)?e:[e]}function each(e,n){for(var t in e)e.hasOwnProperty(t)&&n(e[t],t)}function map(e,n){var t=isArray(e)?[]:{};for(var i in e)e.hasOwnProperty(i)&&(t[i]=n(e[i],i));return t}function filter(e,n){var t=isArray(e),i=t?[]:{};for(var o in e)e.hasOwnProperty(o)&&n(e[o],o)&&(t?i.push(e[o]):i[o]=e[o]);return i}var binaryBase64=function(e){var n,t,i,o="";for(n=0,t=e.length/2;n<t;n++)i=parseInt(e[n*2]+e[n*2+1],16),o+=String.fromCharCode(i);return btoa(o)},uuid=function(){var e=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},hasMissingParams=function(e,n){var t=n.Bucket,i=n.Region,o=n.Key,r=this.options.Domain,s=!r||typeof r=="string"&&r.indexOf("{Bucket}")>-1,u=!r||typeof r=="string"&&r.indexOf("{Region}")>-1;if(e.indexOf("Bucket")>-1||e==="deleteMultipleObject"||e==="multipartList"||e==="listObjectVersions"){if(s&&!t)return"Bucket";if(u&&!i)return"Region"}else if(e.indexOf("Object")>-1||e.indexOf("multipart")>-1||e==="sliceUploadFile"||e==="abortUploadTask"){if(s&&!t)return"Bucket";if(u&&!i)return"Region";if(!o)return"Key"}return!1},formatParams=function(e,n){if(n=extend({},n),e!=="getAuth"&&e!=="getV4Auth"&&e!=="getObjectUrl"){var t=n.Headers||{};if(n&&typeof n=="object"){(function(){for(var o in n)n.hasOwnProperty(o)&&o.indexOf("x-cos-")>-1&&(t[o]=n[o])})();var i={"x-cos-mfa":"MFA","Content-MD5":"ContentMD5","Content-Length":"ContentLength","Content-Type":"ContentType",Expect:"Expect",Expires:"Expires","Cache-Control":"CacheControl","Content-Disposition":"ContentDisposition","Content-Encoding":"ContentEncoding",Range:"Range","If-Modified-Since":"IfModifiedSince","If-Unmodified-Since":"IfUnmodifiedSince","If-Match":"IfMatch","If-None-Match":"IfNoneMatch","x-cos-copy-source":"CopySource","x-cos-copy-source-Range":"CopySourceRange","x-cos-metadata-directive":"MetadataDirective","x-cos-copy-source-If-Modified-Since":"CopySourceIfModifiedSince","x-cos-copy-source-If-Unmodified-Since":"CopySourceIfUnmodifiedSince","x-cos-copy-source-If-Match":"CopySourceIfMatch","x-cos-copy-source-If-None-Match":"CopySourceIfNoneMatch","x-cos-acl":"ACL","x-cos-grant-read":"GrantRead","x-cos-grant-write":"GrantWrite","x-cos-grant-full-control":"GrantFullControl","x-cos-grant-read-acp":"GrantReadAcp","x-cos-grant-write-acp":"GrantWriteAcp","x-cos-storage-class":"StorageClass","x-cos-traffic-limit":"TrafficLimit","x-cos-mime-limit":"MimeLimit","x-cos-server-side-encryption-customer-algorithm":"SSECustomerAlgorithm","x-cos-server-side-encryption-customer-key":"SSECustomerKey","x-cos-server-side-encryption-customer-key-MD5":"SSECustomerKeyMD5","x-cos-server-side-encryption":"ServerSideEncryption","x-cos-server-side-encryption-cos-kms-key-id":"SSEKMSKeyId","x-cos-server-side-encryption-context":"SSEContext"};util$5.each(i,function(o,r){n[o]!==void 0&&(t[r]=n[o])}),n.Headers=clearKey(t)}}return n},apiWrapper=function(e,n){return function(t,i){var o=this;typeof t=="function"&&(i=t,t={}),t=formatParams(e,t);var r=function(a){return a&&a.headers&&(a.headers["x-cos-request-id"]&&(a.RequestId=a.headers["x-cos-request-id"]),a.headers["x-ci-request-id"]&&(a.RequestId=a.headers["x-ci-request-id"]),a.headers["x-cos-version-id"]&&(a.VersionId=a.headers["x-cos-version-id"]),a.headers["x-cos-delete-marker"]&&(a.DeleteMarker=a.headers["x-cos-delete-marker"])),a},s=function(a,d){i&&i(r(a),r(d))},u=function(){if(e!=="getService"&&e!=="abortUploadTask"){var a=hasMissingParams.call(o,e,t);if(a)return"missing param "+a;if(t.Region){if(o.options.CompatibilityMode){if(!/^([a-z\d-.]+)$/.test(t.Region))return"Region format error."}else{if(t.Region.indexOf("cos.")>-1)return'param Region should not be start with "cos."';if(!/^([a-z\d-]+)$/.test(t.Region))return"Region format error."}!o.options.CompatibilityMode&&t.Region.indexOf("-")===-1&&t.Region!=="yfb"&&t.Region!=="default"&&t.Region!=="accelerate"&&console.warn("warning: param Region format error, find help here: https://cloud.tencent.com/document/product/436/6224")}if(t.Bucket){if(!/^([a-z\d-]+)-(\d+)$/.test(t.Bucket))if(t.AppId)t.Bucket=t.Bucket+"-"+t.AppId;else if(o.options.AppId)t.Bucket=t.Bucket+"-"+o.options.AppId;else return'Bucket should format as "test-1250000000".';t.AppId&&(console.warn('warning: AppId has been deprecated, Please put it at the end of parameter Bucket(E.g Bucket:"test-1250000000" ).'),delete t.AppId)}!o.options.UseRawKey&&t.Key&&t.Key.substr(0,1)==="/"&&(t.Key=t.Key.substr(1))}},c=u(),f=e==="getAuth"||e==="getObjectUrl";if(typeof Promise=="function"&&!f&&!i)return new Promise(function(a,d){if(i=function(y,R){y?d(y):a(R)},c)return s(util$5.error(new Error(c)));n.call(o,t,s)});if(c)return s(util$5.error(new Error(c)));var l=n.call(o,t,s);if(f)return l}},throttleOnProgress=function(e,n){var t=this,i=0,o=0,r=Date.now(),s,u;function c(){if(u=0,n&&typeof n=="function"){s=Date.now();var f=Math.max(0,Math.round((o-i)/((s-r)/1e3)*100)/100)||0,l;o===0&&e===0?l=1:l=Math.floor(o/e*100)/100||0,r=s,i=o;try{n({loaded:o,total:e,speed:f,percent:l})}catch{}}}return function(f,l){if(f&&(o=f.loaded,e=f.total),l)clearTimeout(u),c();else{if(u)return;u=setTimeout(c,t.options.ProgressInterval)}}},getFileSize=function(e,n,t){var i;if(typeof n.Body=="string"?n.Body=new Blob([n.Body],{type:"text/plain"}):n.Body instanceof ArrayBuffer&&(n.Body=new Blob([n.Body])),n.Body&&(n.Body instanceof Blob||n.Body.toString()==="[object File]"||n.Body.toString()==="[object Blob]"))i=n.Body.size;else{t(util$5.error(new Error("params body format error, Only allow File|Blob|String.")));return}n.ContentLength=i,t(null,i)},getSkewTime=function(e){return Date.now()+(e||0)},error=function(e,n){var t=e;return e.message=e.message||null,typeof n=="string"?(e.error=n,e.message=n):typeof n=="object"&&n!==null&&(extend(e,n),(n.code||n.name)&&(e.code=n.code||n.name),n.message&&(e.message=n.message),n.stack&&(e.stack=n.stack)),typeof Object.defineProperty=="function"&&(Object.defineProperty(e,"name",{writable:!0,enumerable:!1}),Object.defineProperty(e,"message",{enumerable:!0})),e.name=n&&n.name||e.name||e.code||"Error",e.code||(e.code=e.name),e.error||(e.error=clone(t)),e},isNode=function(){return typeof window!="object"&&typeof process=="object"&&typeof commonjsRequire=="function"},isCIHost=function(e){return/^https?:\/\/([^/]+\.)?ci\.[^/]+/.test(e)},util$5={noop,formatParams,apiWrapper,xml2json,json2xml,md5,clearKey,fileSlice,getBodyMd5,getFileMd5,binaryBase64,extend,isArray,isInArray,makeArray,each,map,filter,clone,attr,uuid,camSafeUrlEncode,throttleOnProgress,getFileSize,getSkewTime,error,obj2str,getAuth:getAuth$1,parseSelectPayload,getSourceParams,isBrowser:!0,isNode,isCIHost},util_1=util$5,event$1={},initEvent=function(e){var n={},t=function(i){return!n[i]&&(n[i]=[]),n[i]};e.on=function(i,o){i==="task-list-update"&&console.warn('warning: Event "'+i+'" has been deprecated. Please use "list-update" instead.'),t(i).push(o)},e.off=function(i,o){for(var r=t(i),s=r.length-1;s>=0;s--)o===r[s]&&r.splice(s,1)},e.emit=function(i,o){for(var r=t(i).map(function(u){return u}),s=0;s<r.length;s++)r[s](o)}},EventProxy$1=function(){initEvent(this)};event$1.init=initEvent;event$1.EventProxy=EventProxy$1;var task$1={},util$4=util_1,cacheKey="cos_sdk_upload_cache",expires=30*24*3600,cache,timer,getCache=function(){try{var e=JSON.parse(localStorage.getItem(cacheKey))}catch{}e||(e=[]),cache=e},setCache=function(){try{localStorage.setItem(cacheKey,JSON.stringify(cache))}catch{}},init=function(){if(!cache){getCache.call(this);for(var e=!1,n=Math.round(Date.now()/1e3),t=cache.length-1;t>=0;t--){var i=cache[t][2];(!i||i+expires<n)&&(cache.splice(t,1),e=!0)}e&&setCache()}},save=function(){timer||(timer=setTimeout(function(){setCache(),timer=null},400))},mod={using:{},setUsing:function(e){mod.using[e]=!0},removeUsing:function(e){delete mod.using[e]},getFileId:function(e,n,t,i){return e.name&&e.size&&e.lastModifiedDate&&n?util$4.md5([e.name,e.size,e.lastModifiedDate,n,t,i].join("::")):null},getUploadIdList:function(e){if(!e)return null;init.call(this);for(var n=[],t=0;t<cache.length;t++)cache[t][0]===e&&n.push(cache[t][1]);return n.length?n:null},saveUploadId:function(e,n,t){if(init.call(this),!!e){for(var i=cache.length-1;i>=0;i--){var o=cache[i];o[0]===e&&o[1]===n&&cache.splice(i,1)}cache.unshift([e,n,Math.round(Date.now()/1e3)]),cache.length>t&&cache.splice(t),save()}},removeUploadId:function(e){init.call(this),delete mod.using[e];for(var n=cache.length-1;n>=0;n--)cache[n][1]===e&&cache.splice(n,1);save()}},session$2=mod,session$1=session$2,util$3=util_1,originApiMap={},transferToTaskMethod=function(e,n){originApiMap[n]=e[n],e[n]=function(t,i){t.SkipTask?originApiMap[n].call(this,t,i):this._addTask(n,t,i)}},initTask=function(e){var n=[],t={},i=0,o=0,r=function(a){var d={id:a.id,Bucket:a.Bucket,Region:a.Region,Key:a.Key,FilePath:a.FilePath,state:a.state,loaded:a.loaded,size:a.size,speed:a.speed,percent:a.percent,hashPercent:a.hashPercent,error:a.error};return a.FilePath&&(d.FilePath=a.FilePath),a._custom&&(d._custom=a._custom),d},s=function(){var a,d=function(){a=0,e.emit("task-list-update",{list:util$3.map(n,r)}),e.emit("list-update",{list:util$3.map(n,r)})};return function(){a||(a=setTimeout(d))}}(),u=function(){if(!(n.length<=e.options.UploadQueueSize)){for(var a=0;a<o&&a<n.length&&n.length>e.options.UploadQueueSize;){var d=n[a].state==="waiting"||n[a].state==="checking"||n[a].state==="uploading";!n[a]||!d?(t[n[a].id]&&delete t[n[a].id],n.splice(a,1),o--):a++}s()}},c=function(){if(!(i>=e.options.FileParallelLimit)){for(;n[o]&&n[o].state!=="waiting";)o++;if(!(o>=n.length)){var a=n[o];o++,i++,a.state="checking",a.params.onTaskStart&&a.params.onTaskStart(r(a)),!a.params.UploadData&&(a.params.UploadData={});var d=util$3.formatParams(a.api,a.params);originApiMap[a.api].call(e,d,function(y,R){!e._isRunningTask(a.id)||((a.state==="checking"||a.state==="uploading")&&(a.state=y?"error":"success",y&&(a.error=y),i--,s(),c(),a.callback&&a.callback(y,R),a.state==="success"&&(a.params&&(delete a.params.UploadData,delete a.params.Body,delete a.params),delete a.callback)),u())}),s(),setTimeout(c)}}},f=function(a,d){var y=t[a];if(!!y){var R=y&&y.state==="waiting",g=y&&(y.state==="checking"||y.state==="uploading");if(d==="canceled"&&y.state!=="canceled"||d==="paused"&&R||d==="paused"&&g){if(d==="paused"&&y.params.Body&&typeof y.params.Body.pipe=="function"){console.error("stream not support pause");return}y.state=d,e.emit("inner-kill-task",{TaskId:a,toState:d});try{var h=y&&y.params&&y.params.UploadData.UploadId}catch{}d==="canceled"&&h&&session$1.removeUsing(h),s(),g&&(i--,c()),d==="canceled"&&(y.params&&(delete y.params.UploadData,delete y.params.Body,delete y.params),delete y.callback)}u()}};e._addTasks=function(a){util$3.each(a,function(d){e._addTask(d.api,d.params,d.callback,!0)}),s()};var l=!0;e._addTask=function(a,d,y,R){d=util$3.formatParams(a,d);var g=util$3.uuid();d.TaskId=g,d.onTaskReady&&d.onTaskReady(g),d.TaskReady&&(d.TaskReady(g),l&&console.warn('warning: Param "TaskReady" has been deprecated. Please use "onTaskReady" instead.'),l=!1);var h={params:d,callback:y,api:a,index:n.length,id:g,Bucket:d.Bucket,Region:d.Region,Key:d.Key,FilePath:d.FilePath||"",state:"waiting",loaded:0,size:0,speed:0,percent:0,hashPercent:0,error:null,_custom:d._custom},C=d.onHashProgress;d.onHashProgress=function(v){!e._isRunningTask(h.id)||(h.hashPercent=v.percent,C&&C(v),s())};var p=d.onProgress;return d.onProgress=function(v){!e._isRunningTask(h.id)||(h.state==="checking"&&(h.state="uploading"),h.loaded=v.loaded,h.speed=v.speed,h.percent=v.percent,p&&p(v),s())},util$3.getFileSize(a,d,function(v,S){if(v)return y(util$3.error(v));t[g]=h,n.push(h),h.size=S,!R&&s(),c(),u()}),g},e._isRunningTask=function(a){var d=t[a];return!!(d&&(d.state==="checking"||d.state==="uploading"))},e.getTaskList=function(){return util$3.map(n,r)},e.cancelTask=function(a){f(a,"canceled")},e.pauseTask=function(a){f(a,"paused")},e.restartTask=function(a){var d=t[a];d&&(d.state==="paused"||d.state==="error")&&(d.state="waiting",s(),o=Math.min(o,d.index),c())},e.isUploadRunning=function(){return i||o<n.length}};task$1.transferToTaskMethod=transferToTaskMethod;task$1.init=initTask;var base$1={},stringifyPrimitive=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},queryStringify=function(e,n,t,i){return n=n||"&",t=t||"=",e===null&&(e=void 0),typeof e=="object"?Object.keys(e).map(function(o){var r=encodeURIComponent(stringifyPrimitive(o))+t;return Array.isArray(e[o])?e[o].map(function(s){return r+encodeURIComponent(stringifyPrimitive(s))}).join(n):r+encodeURIComponent(stringifyPrimitive(e[o]))}).filter(Boolean).join(n):i?encodeURIComponent(stringifyPrimitive(i))+t+encodeURIComponent(stringifyPrimitive(e)):""},xhrRes=function(e,n,t){var i={};return n.getAllResponseHeaders().trim().split(`
`).forEach(function(o){if(o){var r=o.indexOf(":"),s=o.substr(0,r).trim().toLowerCase(),u=o.substr(r+1).trim();i[s]=u}}),{error:e,statusCode:n.status,statusMessage:n.statusText,headers:i,body:t}},xhrBody=function(e,n){return!n&&n==="text"?e.responseText:e.response},request$1=function(e,n){var t=(e.method||"GET").toUpperCase(),i=e.url;if(e.qs){var o=queryStringify(e.qs);o&&(i+=(i.indexOf("?")===-1?"?":"&")+o)}var r=new XMLHttpRequest;if(r.open(t,i,!0),r.responseType=e.dataType||"text",e.xhrFields)for(var s in e.xhrFields)r[s]=e.xhrFields[s];var u=e.headers;if(u)for(var c in u)u.hasOwnProperty(c)&&c.toLowerCase()!=="content-length"&&c.toLowerCase()!=="user-agent"&&c.toLowerCase()!=="origin"&&c.toLowerCase()!=="host"&&r.setRequestHeader(c,u[c]);return e.onProgress&&r.upload&&(r.upload.onprogress=e.onProgress),e.onDownloadProgress&&(r.onprogress=e.onDownloadProgress),e.timeout&&(r.timeout=e.timeout),r.ontimeout=function(f){var l=new Error("timeout");n(xhrRes(l,r))},r.onload=function(){n(xhrRes(null,r,xhrBody(r,e.dataType)))},r.onerror=function(f){var l=xhrBody(r,e.dataType);if(l)n(xhrRes(null,r,l));else{var a=r.statusText;!a&&r.status===0&&(a=new Error("CORS blocked or network error")),n(xhrRes(a,r,l))}},r.send(e.body||""),r},request_1=request$1,REQUEST=request_1,util$2=util_1;function getService(e,n){typeof e=="function"&&(n=e,e={});var t=this.options.Protocol||(util$2.isBrowser&&location.protocol==="http:"?"http:":"https:"),i=this.options.ServiceDomain,o=e.AppId||this.options.appId,r=e.Region;i?(i=i.replace(/\{\{AppId\}\}/ig,o||"").replace(/\{\{Region\}\}/ig,r||"").replace(/\{\{.*?\}\}/ig,""),/^[a-zA-Z]+:\/\//.test(i)||(i=t+"//"+i),i.slice(-1)==="/"&&(i=i.slice(0,-1))):r?i=t+"//cos."+r+".myqcloud.com":i=t+"//service.cos.myqcloud.com";var s="",u=r?"cos."+r+".myqcloud.com":"service.cos.myqcloud.com",c=i.replace(/^https?:\/\/([^/]+)(\/.*)?$/,"$1");u===c&&(s=u),submitRequest.call(this,{Action:"name/cos:GetService",url:i,method:"GET",headers:e.Headers,SignHost:s},function(f,l){if(f)return n(f);var a=l&&l.ListAllMyBucketsResult&&l.ListAllMyBucketsResult.Buckets&&l.ListAllMyBucketsResult.Buckets.Bucket||[];a=util$2.isArray(a)?a:[a];var d=l&&l.ListAllMyBucketsResult&&l.ListAllMyBucketsResult.Owner||{};n(null,{Buckets:a,Owner:d,statusCode:l.statusCode,headers:l.headers})})}function putBucket(e,n){var t=this,i="";if(e.BucketAZConfig){var o={BucketAZConfig:e.BucketAZConfig};i=util$2.json2xml({CreateBucketConfiguration:o})}submitRequest.call(this,{Action:"name/cos:PutBucket",method:"PUT",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,body:i},function(r,s){if(r)return n(r);var u=getUrl({protocol:t.options.Protocol,domain:t.options.Domain,bucket:e.Bucket,region:e.Region,isLocation:!0});n(null,{Location:u,statusCode:s.statusCode,headers:s.headers})})}function headBucket(e,n){submitRequest.call(this,{Action:"name/cos:HeadBucket",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,method:"HEAD"},n)}function getBucket(e,n){var t={};t.prefix=e.Prefix||"",t.delimiter=e.Delimiter,t.marker=e.Marker,t["max-keys"]=e.MaxKeys,t["encoding-type"]=e.EncodingType,submitRequest.call(this,{Action:"name/cos:GetBucket",ResourceKey:t.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:t},function(i,o){if(i)return n(i);var r=o.ListBucketResult||{},s=r.Contents||[],u=r.CommonPrefixes||[];s=util$2.isArray(s)?s:[s],u=util$2.isArray(u)?u:[u];var c=util$2.clone(r);util$2.extend(c,{Contents:s,CommonPrefixes:u,statusCode:o.statusCode,headers:o.headers}),n(null,c)})}function deleteBucket(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucket",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,method:"DELETE"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function putBucketAcl(e,n){var t=e.Headers,i="";if(e.AccessControlPolicy){var o=util$2.clone(e.AccessControlPolicy||{}),r=o.Grants||o.Grant;r=util$2.isArray(r)?r:[r],delete o.Grant,delete o.Grants,o.AccessControlList={Grant:r},i=util$2.json2xml({AccessControlPolicy:o}),t["Content-Type"]="application/xml",t["Content-MD5"]=util$2.binaryBase64(util$2.md5(i))}util$2.each(t,function(s,u){u.indexOf("x-cos-grant-")===0&&(t[u]=uniqGrant(t[u]))}),submitRequest.call(this,{Action:"name/cos:PutBucketACL",method:"PUT",Bucket:e.Bucket,Region:e.Region,headers:t,action:"acl",body:i},function(s,u){if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getBucketAcl(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketACL",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"acl"},function(t,i){if(t)return n(t);var o=i.AccessControlPolicy||{},r=o.Owner||{},s=o.AccessControlList.Grant||[];s=util$2.isArray(s)?s:[s];var u=decodeAcl(o);i.headers&&i.headers["x-cos-acl"]&&(u.ACL=i.headers["x-cos-acl"]),u=util$2.extend(u,{Owner:r,Grants:s,statusCode:i.statusCode,headers:i.headers}),n(null,u)})}function putBucketCors(e,n){var t=e.CORSConfiguration||{},i=t.CORSRules||e.CORSRules||[];i=util$2.clone(util$2.isArray(i)?i:[i]),util$2.each(i,function(u){util$2.each(["AllowedOrigin","AllowedHeader","AllowedMethod","ExposeHeader"],function(c){var f=c+"s",l=u[f]||u[c]||[];delete u[f],u[c]=util$2.isArray(l)?l:[l]})});var o={CORSRule:i};e.ResponseVary&&(o.ResponseVary=e.ResponseVary);var r=util$2.json2xml({CORSConfiguration:o}),s=e.Headers;s["Content-Type"]="application/xml",s["Content-MD5"]=util$2.binaryBase64(util$2.md5(r)),submitRequest.call(this,{Action:"name/cos:PutBucketCORS",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:r,action:"cors",headers:s},function(u,c){if(u)return n(u);n(null,{statusCode:c.statusCode,headers:c.headers})})}function getBucketCors(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketCORS",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"cors"},function(t,i){if(t){if(t.statusCode===404&&t.error&&t.error.Code==="NoSuchCORSConfiguration"){var o={CORSRules:[],statusCode:t.statusCode};t.headers&&(o.headers=t.headers),n(null,o)}else n(t);return}var r=i.CORSConfiguration||{},s=r.CORSRules||r.CORSRule||[];s=util$2.clone(util$2.isArray(s)?s:[s]);var u=r.ResponseVary;util$2.each(s,function(c){util$2.each(["AllowedOrigin","AllowedHeader","AllowedMethod","ExposeHeader"],function(f){var l=f+"s",a=c[l]||c[f]||[];delete c[f],c[l]=util$2.isArray(a)?a:[a]})}),n(null,{CORSRules:s,ResponseVary:u,statusCode:i.statusCode,headers:i.headers})})}function deleteBucketCors(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketCORS",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"cors"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode||t.statusCode,headers:i.headers})})}function getBucketLocation(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketLocation",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"location"},n)}function putBucketPolicy(e,n){var t=e.Policy;try{typeof t=="string"&&(t=JSON.parse(t))}catch{}if(!t||typeof t=="string")return n(util$2.error(new Error("Policy format error")));var i=JSON.stringify(t);t.version||(t.version="2.0");var o=e.Headers;o["Content-Type"]="application/json",o["Content-MD5"]=util$2.binaryBase64(util$2.md5(i)),submitRequest.call(this,{Action:"name/cos:PutBucketPolicy",method:"PUT",Bucket:e.Bucket,Region:e.Region,action:"policy",body:i,headers:o},function(r,s){if(r&&r.statusCode===204)return n(null,{statusCode:r.statusCode});if(r)return n(r);n(null,{statusCode:s.statusCode,headers:s.headers})})}function getBucketPolicy(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketPolicy",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"policy",rawBody:!0},function(t,i){if(t)return t.statusCode&&t.statusCode===403?n(util$2.error(t,{ErrorStatus:"Access Denied"})):t.statusCode&&t.statusCode===405?n(util$2.error(t,{ErrorStatus:"Method Not Allowed"})):t.statusCode&&t.statusCode===404?n(util$2.error(t,{ErrorStatus:"Policy Not Found"})):n(t);var o={};try{o=JSON.parse(i.body)}catch{}n(null,{Policy:o,statusCode:i.statusCode,headers:i.headers})})}function deleteBucketPolicy(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketPolicy",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"policy"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode||t.statusCode,headers:i.headers})})}function putBucketTagging(e,n){var t=e.Tagging||{},i=t.TagSet||t.Tags||e.Tags||[];i=util$2.clone(util$2.isArray(i)?i:[i]);var o=util$2.json2xml({Tagging:{TagSet:{Tag:i}}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:PutBucketTagging",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:o,action:"tagging",headers:r},function(s,u){if(s&&s.statusCode===204)return n(null,{statusCode:s.statusCode});if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getBucketTagging(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketTagging",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging"},function(t,i){if(t){if(t.statusCode===404&&t.error&&(t.error==="Not Found"||t.error.Code==="NoSuchTagSet")){var o={Tags:[],statusCode:t.statusCode};t.headers&&(o.headers=t.headers),n(null,o)}else n(t);return}var r=[];try{r=i.Tagging.TagSet.Tag||[]}catch{}r=util$2.clone(util$2.isArray(r)?r:[r]),n(null,{Tags:r,statusCode:i.statusCode,headers:i.headers})})}function deleteBucketTagging(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketTagging",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function putBucketLifecycle(e,n){var t=e.LifecycleConfiguration||{},i=t.Rules||e.Rules||[];i=util$2.clone(i);var o=util$2.json2xml({LifecycleConfiguration:{Rule:i}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:PutBucketLifecycle",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:o,action:"lifecycle",headers:r},function(s,u){if(s&&s.statusCode===204)return n(null,{statusCode:s.statusCode});if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getBucketLifecycle(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketLifecycle",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"lifecycle"},function(t,i){if(t){if(t.statusCode===404&&t.error&&t.error.Code==="NoSuchLifecycleConfiguration"){var o={Rules:[],statusCode:t.statusCode};t.headers&&(o.headers=t.headers),n(null,o)}else n(t);return}var r=[];try{r=i.LifecycleConfiguration.Rule||[]}catch{}r=util$2.clone(util$2.isArray(r)?r:[r]),n(null,{Rules:r,statusCode:i.statusCode,headers:i.headers})})}function deleteBucketLifecycle(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketLifecycle",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"lifecycle"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function putBucketVersioning(e,n){if(!e.VersioningConfiguration){n(util$2.error(new Error("missing param VersioningConfiguration")));return}var t=e.VersioningConfiguration||{},i=util$2.json2xml({VersioningConfiguration:t}),o=e.Headers;o["Content-Type"]="application/xml",o["Content-MD5"]=util$2.binaryBase64(util$2.md5(i)),submitRequest.call(this,{Action:"name/cos:PutBucketVersioning",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:i,action:"versioning",headers:o},function(r,s){if(r&&r.statusCode===204)return n(null,{statusCode:r.statusCode});if(r)return n(r);n(null,{statusCode:s.statusCode,headers:s.headers})})}function getBucketVersioning(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketVersioning",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"versioning"},function(t,i){t||!i.VersioningConfiguration&&(i.VersioningConfiguration={}),n(t,i)})}function putBucketReplication(e,n){var t=util$2.clone(e.ReplicationConfiguration),i=util$2.json2xml({ReplicationConfiguration:t});i=i.replace(/<(\/?)Rules>/ig,"<$1Rule>"),i=i.replace(/<(\/?)Tags>/ig,"<$1Tag>");var o=e.Headers;o["Content-Type"]="application/xml",o["Content-MD5"]=util$2.binaryBase64(util$2.md5(i)),submitRequest.call(this,{Action:"name/cos:PutBucketReplication",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:i,action:"replication",headers:o},function(r,s){if(r&&r.statusCode===204)return n(null,{statusCode:r.statusCode});if(r)return n(r);n(null,{statusCode:s.statusCode,headers:s.headers})})}function getBucketReplication(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketReplication",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"replication"},function(t,i){if(t){if(t.statusCode===404&&t.error&&(t.error==="Not Found"||t.error.Code==="ReplicationConfigurationnotFoundError")){var o={ReplicationConfiguration:{Rules:[]},statusCode:t.statusCode};t.headers&&(o.headers=t.headers),n(null,o)}else n(t);return}!i.ReplicationConfiguration&&(i.ReplicationConfiguration={}),i.ReplicationConfiguration.Rule&&(i.ReplicationConfiguration.Rules=util$2.makeArray(i.ReplicationConfiguration.Rule),delete i.ReplicationConfiguration.Rule),n(t,i)})}function deleteBucketReplication(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketReplication",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"replication"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function putBucketWebsite(e,n){if(!e.WebsiteConfiguration){n(util$2.error(new Error("missing param WebsiteConfiguration")));return}var t=util$2.clone(e.WebsiteConfiguration||{}),i=t.RoutingRules||t.RoutingRule||[];i=util$2.isArray(i)?i:[i],delete t.RoutingRule,delete t.RoutingRules,i.length&&(t.RoutingRules={RoutingRule:i});var o=util$2.json2xml({WebsiteConfiguration:t}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:PutBucketWebsite",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:o,action:"website",headers:r},function(s,u){if(s&&s.statusCode===204)return n(null,{statusCode:s.statusCode});if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getBucketWebsite(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketWebsite",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"website"},function(t,i){if(t){if(t.statusCode===404&&t.error.Code==="NoSuchWebsiteConfiguration"){var o={WebsiteConfiguration:{},statusCode:t.statusCode};t.headers&&(o.headers=t.headers),n(null,o)}else n(t);return}var r=i.WebsiteConfiguration||{};if(r.RoutingRules){var s=util$2.clone(r.RoutingRules.RoutingRule||[]);s=util$2.makeArray(s),r.RoutingRules=s}n(null,{WebsiteConfiguration:r,statusCode:i.statusCode,headers:i.headers})})}function deleteBucketWebsite(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketWebsite",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"website"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function putBucketReferer(e,n){if(!e.RefererConfiguration){n(util$2.error(new Error("missing param RefererConfiguration")));return}var t=util$2.clone(e.RefererConfiguration||{}),i=t.DomainList||{},o=i.Domains||i.Domain||[];o=util$2.isArray(o)?o:[o],o.length&&(t.DomainList={Domain:o});var r=util$2.json2xml({RefererConfiguration:t}),s=e.Headers;s["Content-Type"]="application/xml",s["Content-MD5"]=util$2.binaryBase64(util$2.md5(r)),submitRequest.call(this,{Action:"name/cos:PutBucketReferer",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:r,action:"referer",headers:s},function(u,c){if(u&&u.statusCode===204)return n(null,{statusCode:u.statusCode});if(u)return n(u);n(null,{statusCode:c.statusCode,headers:c.headers})})}function getBucketReferer(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketReferer",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"referer"},function(t,i){if(t){if(t.statusCode===404&&t.error.Code==="NoSuchRefererConfiguration"){var o={WebsiteConfiguration:{},statusCode:t.statusCode};t.headers&&(o.headers=t.headers),n(null,o)}else n(t);return}var r=i.RefererConfiguration||{};if(r.DomainList){var s=util$2.makeArray(r.DomainList.Domain||[]);r.DomainList={Domains:s}}n(null,{RefererConfiguration:r,statusCode:i.statusCode,headers:i.headers})})}function putBucketDomain(e,n){var t=e.DomainConfiguration||{},i=t.DomainRule||e.DomainRule||[];i=util$2.clone(i);var o=util$2.json2xml({DomainConfiguration:{DomainRule:i}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:PutBucketDomain",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:o,action:"domain",headers:r},function(s,u){if(s&&s.statusCode===204)return n(null,{statusCode:s.statusCode});if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getBucketDomain(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketDomain",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"domain"},function(t,i){if(t)return n(t);var o=[];try{o=i.DomainConfiguration.DomainRule||[]}catch{}o=util$2.clone(util$2.isArray(o)?o:[o]),n(null,{DomainRule:o,statusCode:i.statusCode,headers:i.headers})})}function deleteBucketDomain(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketDomain",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"domain"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function putBucketOrigin(e,n){var t=e.OriginConfiguration||{},i=t.OriginRule||e.OriginRule||[];i=util$2.clone(i);var o=util$2.json2xml({OriginConfiguration:{OriginRule:i}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:PutBucketOrigin",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:o,action:"origin",headers:r},function(s,u){if(s&&s.statusCode===204)return n(null,{statusCode:s.statusCode});if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getBucketOrigin(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketOrigin",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"origin"},function(t,i){if(t)return n(t);var o=[];try{o=i.OriginConfiguration.OriginRule||[]}catch{}o=util$2.clone(util$2.isArray(o)?o:[o]),n(null,{OriginRule:o,statusCode:i.statusCode,headers:i.headers})})}function deleteBucketOrigin(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketOrigin",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"origin"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function putBucketLogging(e,n){var t=util$2.json2xml({BucketLoggingStatus:e.BucketLoggingStatus||""}),i=e.Headers;i["Content-Type"]="application/xml",i["Content-MD5"]=util$2.binaryBase64(util$2.md5(t)),submitRequest.call(this,{Action:"name/cos:PutBucketLogging",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:t,action:"logging",headers:i},function(o,r){if(o&&o.statusCode===204)return n(null,{statusCode:o.statusCode});if(o)return n(o);n(null,{statusCode:r.statusCode,headers:r.headers})})}function getBucketLogging(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketLogging",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"logging"},function(t,i){if(t)return n(t);n(null,{BucketLoggingStatus:i.BucketLoggingStatus,statusCode:i.statusCode,headers:i.headers})})}function putBucketInventory(e,n){var t=util$2.clone(e.InventoryConfiguration);if(t.OptionalFields){var i=t.OptionalFields||[];t.OptionalFields={Field:i}}if(t.Destination&&t.Destination.COSBucketDestination&&t.Destination.COSBucketDestination.Encryption){var o=t.Destination.COSBucketDestination.Encryption;Object.keys(o).indexOf("SSECOS")>-1&&(o["SSE-COS"]=o.SSECOS,delete o.SSECOS)}var r=util$2.json2xml({InventoryConfiguration:t}),s=e.Headers;s["Content-Type"]="application/xml",s["Content-MD5"]=util$2.binaryBase64(util$2.md5(r)),submitRequest.call(this,{Action:"name/cos:PutBucketInventory",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:r,action:"inventory",qs:{id:e.Id},headers:s},function(u,c){if(u&&u.statusCode===204)return n(null,{statusCode:u.statusCode});if(u)return n(u);n(null,{statusCode:c.statusCode,headers:c.headers})})}function getBucketInventory(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketInventory",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"inventory",qs:{id:e.Id}},function(t,i){if(t)return n(t);var o=i.InventoryConfiguration;if(o&&o.OptionalFields&&o.OptionalFields.Field){var r=o.OptionalFields.Field;util$2.isArray(r)||(r=[r]),o.OptionalFields=r}if(o.Destination&&o.Destination.COSBucketDestination&&o.Destination.COSBucketDestination.Encryption){var s=o.Destination.COSBucketDestination.Encryption;Object.keys(s).indexOf("SSE-COS")>-1&&(s.SSECOS=s["SSE-COS"],delete s["SSE-COS"])}n(null,{InventoryConfiguration:o,statusCode:i.statusCode,headers:i.headers})})}function listBucketInventory(e,n){submitRequest.call(this,{Action:"name/cos:ListBucketInventory",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"inventory",qs:{"continuation-token":e.ContinuationToken}},function(t,i){if(t)return n(t);var o=i.ListInventoryConfigurationResult,r=o.InventoryConfiguration||[];r=util$2.isArray(r)?r:[r],delete o.InventoryConfiguration,util$2.each(r,function(s){if(s&&s.OptionalFields&&s.OptionalFields.Field){var u=s.OptionalFields.Field;util$2.isArray(u)||(u=[u]),s.OptionalFields=u}if(s.Destination&&s.Destination.COSBucketDestination&&s.Destination.COSBucketDestination.Encryption){var c=s.Destination.COSBucketDestination.Encryption;Object.keys(c).indexOf("SSE-COS")>-1&&(c.SSECOS=c["SSE-COS"],delete c["SSE-COS"])}}),o.InventoryConfigurations=r,util$2.extend(o,{statusCode:i.statusCode,headers:i.headers}),n(null,o)})}function deleteBucketInventory(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketInventory",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"inventory",qs:{id:e.Id}},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function putBucketAccelerate(e,n){if(!e.AccelerateConfiguration){n(util$2.error(new Error("missing param AccelerateConfiguration")));return}var t={AccelerateConfiguration:e.AccelerateConfiguration||{}},i=util$2.json2xml(t),o={};o["Content-Type"]="application/xml",o["Content-MD5"]=util$2.binaryBase64(util$2.md5(i)),submitRequest.call(this,{Action:"name/cos:PutBucketAccelerate",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:i,action:"accelerate",headers:o},function(r,s){if(r)return n(r);n(null,{statusCode:s.statusCode,headers:s.headers})})}function getBucketAccelerate(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketAccelerate",method:"GET",Bucket:e.Bucket,Region:e.Region,action:"accelerate"},function(t,i){t||!i.AccelerateConfiguration&&(i.AccelerateConfiguration={}),n(t,i)})}function putBucketEncryption(e,n){var t=e.ServerSideEncryptionConfiguration||{},i=t.Rule||t.Rules||[],o=util$2.json2xml({ServerSideEncryptionConfiguration:{Rule:i}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:PutBucketEncryption",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:o,action:"encryption",headers:r},function(s,u){if(s&&s.statusCode===204)return n(null,{statusCode:s.statusCode});if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getBucketEncryption(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketEncryption",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"encryption"},function(t,i){if(t){if(t.statusCode===404&&t.code==="NoSuchEncryptionConfiguration"){var o={EncryptionConfiguration:{Rules:[]},statusCode:t.statusCode};t.headers&&(o.headers=t.headers),n(null,o)}else n(t);return}var r=util$2.makeArray(i.EncryptionConfiguration&&i.EncryptionConfiguration.Rule||[]);i.EncryptionConfiguration={Rules:r},n(t,i)})}function deleteBucketEncryption(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketReplication",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"encryption"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function headObject(e,n){submitRequest.call(this,{Action:"name/cos:HeadObject",method:"HEAD",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,headers:e.Headers},function(t,i){if(t){var o=t.statusCode;return e.Headers["If-Modified-Since"]&&o&&o===304?n(null,{NotModified:!0,statusCode:o}):n(t)}i.ETag=util$2.attr(i.headers,"etag",""),n(null,i)})}function listObjectVersions(e,n){var t={};t.prefix=e.Prefix||"",t.delimiter=e.Delimiter,t["key-marker"]=e.KeyMarker,t["version-id-marker"]=e.VersionIdMarker,t["max-keys"]=e.MaxKeys,t["encoding-type"]=e.EncodingType,submitRequest.call(this,{Action:"name/cos:GetBucketObjectVersions",ResourceKey:t.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:t,action:"versions"},function(i,o){if(i)return n(i);var r=o.ListVersionsResult||{},s=r.DeleteMarker||[];s=util$2.isArray(s)?s:[s];var u=r.Version||[];u=util$2.isArray(u)?u:[u];var c=util$2.clone(r);delete c.DeleteMarker,delete c.Version,util$2.extend(c,{DeleteMarkers:s,Versions:u,statusCode:o.statusCode,headers:o.headers}),n(null,c)})}function getObject(e,n){var t=e.Query||{},i=e.QueryString||"",o=util$2.throttleOnProgress.call(this,0,e.onProgress);t["response-content-type"]=e.ResponseContentType,t["response-content-language"]=e.ResponseContentLanguage,t["response-expires"]=e.ResponseExpires,t["response-cache-control"]=e.ResponseCacheControl,t["response-content-disposition"]=e.ResponseContentDisposition,t["response-content-encoding"]=e.ResponseContentEncoding,submitRequest.call(this,{Action:"name/cos:GetObject",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,DataType:e.DataType,headers:e.Headers,qs:t,qsStr:i,rawBody:!0,onDownloadProgress:o},function(r,s){if(o(null,!0),r){var u=r.statusCode;return e.Headers["If-Modified-Since"]&&u&&u===304?n(null,{NotModified:!0}):n(r)}n(null,{Body:s.body,ETag:util$2.attr(s.headers,"etag",""),statusCode:s.statusCode,headers:s.headers})})}function putObject(e,n){var t=this,i=e.ContentLength,o=util$2.throttleOnProgress.call(t,i,e.onProgress),r=e.Headers;!r["Cache-Control"]&&!r["cache-control"]&&(r["Cache-Control"]=""),!r["Content-Type"]&&!r["content-type"]&&(r["Content-Type"]=e.Body&&e.Body.type||"");var s=e.UploadAddMetaMd5||t.options.UploadAddMetaMd5||t.options.UploadCheckContentMd5;util$2.getBodyMd5(s,e.Body,function(u){u&&(t.options.UploadCheckContentMd5&&(r["Content-MD5"]=util$2.binaryBase64(u)),(e.UploadAddMetaMd5||t.options.UploadAddMetaMd5)&&(r["x-cos-meta-md5"]=u)),e.ContentLength!==void 0&&(r["Content-Length"]=e.ContentLength),o(null,!0),submitRequest.call(t,{Action:"name/cos:PutObject",TaskId:e.TaskId,method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:e.Query,body:e.Body,onProgress:o},function(c,f){if(c)return o(null,!0),n(c);o({loaded:i,total:i},!0);var l=getUrl({ForcePathStyle:t.options.ForcePathStyle,protocol:t.options.Protocol,domain:t.options.Domain,bucket:e.Bucket,region:t.options.UseAccelerate?"accelerate":e.Region,object:e.Key});l=l.substr(l.indexOf("://")+3),f.Location=l,f.ETag=util$2.attr(f.headers,"etag",""),n(null,f)})},e.onHashProgress)}function deleteObject(e,n){submitRequest.call(this,{Action:"name/cos:DeleteObject",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,VersionId:e.VersionId,action:e.Recursive?"recursive":""},function(t,i){if(t){var o=t.statusCode;return o&&o===404?n(null,{BucketNotFound:!0,statusCode:o}):n(t)}n(null,{statusCode:i.statusCode,headers:i.headers})})}function getObjectAcl(e,n){submitRequest.call(this,{Action:"name/cos:GetObjectACL",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"acl"},function(t,i){if(t)return n(t);var o=i.AccessControlPolicy||{},r=o.Owner||{},s=o.AccessControlList&&o.AccessControlList.Grant||[];s=util$2.isArray(s)?s:[s];var u=decodeAcl(o);delete u.GrantWrite,i.headers&&i.headers["x-cos-acl"]&&(u.ACL=i.headers["x-cos-acl"]),u=util$2.extend(u,{Owner:r,Grants:s,statusCode:i.statusCode,headers:i.headers}),n(null,u)})}function putObjectAcl(e,n){var t=e.Headers,i="";if(e.AccessControlPolicy){var o=util$2.clone(e.AccessControlPolicy||{}),r=o.Grants||o.Grant;r=util$2.isArray(r)?r:[r],delete o.Grant,delete o.Grants,o.AccessControlList={Grant:r},i=util$2.json2xml({AccessControlPolicy:o}),t["Content-Type"]="application/xml",t["Content-MD5"]=util$2.binaryBase64(util$2.md5(i))}util$2.each(t,function(s,u){u.indexOf("x-cos-grant-")===0&&(t[u]=uniqGrant(t[u]))}),submitRequest.call(this,{Action:"name/cos:PutObjectACL",method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:"acl",headers:t,body:i},function(s,u){if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function optionsObject(e,n){var t=e.Headers;t.Origin=e.Origin,t["Access-Control-Request-Method"]=e.AccessControlRequestMethod,t["Access-Control-Request-Headers"]=e.AccessControlRequestHeaders,submitRequest.call(this,{Action:"name/cos:OptionsObject",method:"OPTIONS",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:t},function(i,o){if(i)return i.statusCode&&i.statusCode===403?n(null,{OptionsForbidden:!0,statusCode:i.statusCode}):n(i);var r=o.headers||{};n(null,{AccessControlAllowOrigin:r["access-control-allow-origin"],AccessControlAllowMethods:r["access-control-allow-methods"],AccessControlAllowHeaders:r["access-control-allow-headers"],AccessControlExposeHeaders:r["access-control-expose-headers"],AccessControlMaxAge:r["access-control-max-age"],statusCode:o.statusCode,headers:o.headers})})}function putObjectCopy(e,n){var t=this,i=e.Headers;!i["Cache-Control"]&&!i["cache-control"]&&(i["Cache-Control"]="");var o=e.CopySource||"",r=util$2.getSourceParams.call(this,o);if(!r){n(util$2.error(new Error("CopySource format error")));return}var s=r[1],u=r[3],c=decodeURIComponent(r[4]);submitRequest.call(this,{Scope:[{action:"name/cos:GetObject",bucket:s,region:u,prefix:c},{action:"name/cos:PutObject",bucket:e.Bucket,region:e.Region,prefix:e.Key}],method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,headers:e.Headers},function(f,l){if(f)return n(f);var a=util$2.clone(l.CopyObjectResult||{}),d=getUrl({ForcePathStyle:t.options.ForcePathStyle,protocol:t.options.Protocol,domain:t.options.Domain,bucket:e.Bucket,region:e.Region,object:e.Key,isLocation:!0});util$2.extend(a,{Location:d,statusCode:l.statusCode,headers:l.headers}),n(null,a)})}function uploadPartCopy(e,n){var t=e.CopySource||"",i=util$2.getSourceParams.call(this,t);if(!i){n(util$2.error(new Error("CopySource format error")));return}var o=i[1],r=i[3],s=decodeURIComponent(i[4]);submitRequest.call(this,{Scope:[{action:"name/cos:GetObject",bucket:o,region:r,prefix:s},{action:"name/cos:PutObject",bucket:e.Bucket,region:e.Region,prefix:e.Key}],method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,qs:{partNumber:e.PartNumber,uploadId:e.UploadId},headers:e.Headers},function(u,c){if(u)return n(u);var f=util$2.clone(c.CopyPartResult||{});util$2.extend(f,{statusCode:c.statusCode,headers:c.headers}),n(null,f)})}function deleteMultipleObject(e,n){var t=e.Objects||[],i=e.Quiet;t=util$2.isArray(t)?t:[t];var o=util$2.json2xml({Delete:{Object:t,Quiet:i||!1}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o));var s=util$2.map(t,function(u){return{action:"name/cos:DeleteObject",bucket:e.Bucket,region:e.Region,prefix:u.Key}});submitRequest.call(this,{Scope:s,method:"POST",Bucket:e.Bucket,Region:e.Region,body:o,action:"delete",headers:r},function(u,c){if(u)return n(u);var f=c.DeleteResult||{},l=f.Deleted||[],a=f.Error||[];l=util$2.isArray(l)?l:[l],a=util$2.isArray(a)?a:[a];var d=util$2.clone(f);util$2.extend(d,{Error:a,Deleted:l,statusCode:c.statusCode,headers:c.headers}),n(null,d)})}function restoreObject(e,n){var t=e.Headers;if(!e.RestoreRequest){n(util$2.error(new Error("missing param RestoreRequest")));return}var i=e.RestoreRequest||{},o=util$2.json2xml({RestoreRequest:i});t["Content-Type"]="application/xml",t["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:RestoreObject",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,body:o,action:"restore",headers:t},n)}function putObjectTagging(e,n){var t=e.Tagging||{},i=t.TagSet||t.Tags||e.Tags||[];i=util$2.clone(util$2.isArray(i)?i:[i]);var o=util$2.json2xml({Tagging:{TagSet:{Tag:i}}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:PutObjectTagging",method:"PUT",Bucket:e.Bucket,Key:e.Key,Region:e.Region,body:o,action:"tagging",headers:r,VersionId:e.VersionId},function(s,u){if(s&&s.statusCode===204)return n(null,{statusCode:s.statusCode});if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getObjectTagging(e,n){submitRequest.call(this,{Action:"name/cos:GetObjectTagging",method:"GET",Key:e.Key,Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging",VersionId:e.VersionId},function(t,i){if(t){if(t.statusCode===404&&t.error&&(t.error==="Not Found"||t.error.Code==="NoSuchTagSet")){var o={Tags:[],statusCode:t.statusCode};t.headers&&(o.headers=t.headers),n(null,o)}else n(t);return}var r=[];try{r=i.Tagging.TagSet.Tag||[]}catch{}r=util$2.clone(util$2.isArray(r)?r:[r]),n(null,{Tags:r,statusCode:i.statusCode,headers:i.headers})})}function deleteObjectTagging(e,n){submitRequest.call(this,{Action:"name/cos:DeleteObjectTagging",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"tagging",VersionId:e.VersionId},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function selectObjectContent(e,n){var t=e.SelectType;if(!t)return n(util$2.error(new Error("missing param SelectType")));var i=e.SelectRequest||{},o=util$2.json2xml({SelectRequest:i}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:GetObject",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"select",qs:{"select-type":e.SelectType},VersionId:e.VersionId,body:o,DataType:"arraybuffer",rawBody:!0},function(s,u){if(s&&s.statusCode===204)return n(null,{statusCode:s.statusCode});if(s)return n(s);var c=util$2.parseSelectPayload(u.body);n(null,{statusCode:u.statusCode,headers:u.headers,Body:c.body,Payload:c.payload})})}function multipartInit(e,n){var t=this,i=e.Headers;!i["Cache-Control"]&&!i["cache-control"]&&(i["Cache-Control"]=""),!i["Content-Type"]&&!i["content-type"]&&(i["Content-Type"]=e.Body&&e.Body.type||""),util$2.getBodyMd5(e.Body&&(e.UploadAddMetaMd5||t.options.UploadAddMetaMd5),e.Body,function(o){o&&(e.Headers["x-cos-meta-md5"]=o),submitRequest.call(t,{Action:"name/cos:InitiateMultipartUpload",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:"uploads",headers:e.Headers,qs:e.Query},function(r,s){if(r)return n(r);if(s=util$2.clone(s||{}),s&&s.InitiateMultipartUploadResult)return n(null,util$2.extend(s.InitiateMultipartUploadResult,{statusCode:s.statusCode,headers:s.headers}));n(null,s)})},e.onHashProgress)}function multipartUpload(e,n){var t=this;util$2.getFileSize("multipartUpload",e,function(){util$2.getBodyMd5(t.options.UploadCheckContentMd5,e.Body,function(i){i&&(e.Headers["Content-MD5"]=util$2.binaryBase64(i)),submitRequest.call(t,{Action:"name/cos:UploadPart",TaskId:e.TaskId,method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,qs:{partNumber:e.PartNumber,uploadId:e.UploadId},headers:e.Headers,onProgress:e.onProgress,body:e.Body||null},function(o,r){if(o)return n(o);n(null,{ETag:util$2.attr(r.headers,"etag",""),statusCode:r.statusCode,headers:r.headers})})})})}function multipartComplete(e,n){for(var t=this,i=e.UploadId,o=e.Parts,r=0,s=o.length;r<s;r++)o[r].ETag&&o[r].ETag.indexOf('"')===0||(o[r].ETag='"'+o[r].ETag+'"');var u=util$2.json2xml({CompleteMultipartUpload:{Part:o}});u=u.replace(/\n\s*/g,"");var c=e.Headers;c["Content-Type"]="application/xml",c["Content-MD5"]=util$2.binaryBase64(util$2.md5(u)),submitRequest.call(this,{Action:"name/cos:CompleteMultipartUpload",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,qs:{uploadId:i},body:u,headers:c},function(f,l){if(f)return n(f);var a=getUrl({ForcePathStyle:t.options.ForcePathStyle,protocol:t.options.Protocol,domain:t.options.Domain,bucket:e.Bucket,region:e.Region,object:e.Key,isLocation:!0}),d=l.CompleteMultipartUploadResult||{};d.ProcessResults&&d&&d.ProcessResults&&(d.UploadResult={OriginalInfo:{Key:d.Key,Location:a,ETag:d.ETag,ImageInfo:d.ImageInfo},ProcessResults:d.ProcessResults},delete d.ImageInfo,delete d.ProcessResults);var y=util$2.extend(d,{Location:a,statusCode:l.statusCode,headers:l.headers});n(null,y)})}function multipartList(e,n){var t={};t.delimiter=e.Delimiter,t["encoding-type"]=e.EncodingType,t.prefix=e.Prefix||"",t["max-uploads"]=e.MaxUploads,t["key-marker"]=e.KeyMarker,t["upload-id-marker"]=e.UploadIdMarker,t=util$2.clearKey(t),submitRequest.call(this,{Action:"name/cos:ListMultipartUploads",ResourceKey:t.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:t,action:"uploads"},function(i,o){if(i)return n(i);if(o&&o.ListMultipartUploadsResult){var r=o.ListMultipartUploadsResult.Upload||[];r=util$2.isArray(r)?r:[r],o.ListMultipartUploadsResult.Upload=r}var s=util$2.clone(o.ListMultipartUploadsResult||{});util$2.extend(s,{statusCode:o.statusCode,headers:o.headers}),n(null,s)})}function multipartListPart(e,n){var t={};t.uploadId=e.UploadId,t["encoding-type"]=e.EncodingType,t["max-parts"]=e.MaxParts,t["part-number-marker"]=e.PartNumberMarker,submitRequest.call(this,{Action:"name/cos:ListParts",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:t},function(i,o){if(i)return n(i);var r=o.ListPartsResult||{},s=r.Part||[];s=util$2.isArray(s)?s:[s],r.Part=s;var u=util$2.clone(r);util$2.extend(u,{statusCode:o.statusCode,headers:o.headers}),n(null,u)})}function multipartAbort(e,n){var t={};t.uploadId=e.UploadId,submitRequest.call(this,{Action:"name/cos:AbortMultipartUpload",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:t},function(i,o){if(i)return n(i);n(null,{statusCode:o.statusCode,headers:o.headers})})}function request(e,n){submitRequest.call(this,{method:e.Method,Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:e.Action,headers:e.Headers,qs:e.Query,body:e.Body,Url:e.Url,rawBody:e.RawBody,DataType:e.DataType},function(t,i){if(t)return n(t);i&&i.body&&(i.Body=i.body,delete i.body),n(t,i)})}function appendObject(e,n){var t=e.Headers;!t["Cache-Control"]&&!t["cache-control"]&&(t["Cache-Control"]=""),!t["Content-Type"]&&!t["content-type"]&&(t["Content-Type"]=e.Body&&e.Body.type||""),submitRequest.call(this,{Action:"name/cos:AppendObject",method:"POST",Bucket:e.Bucket,Region:e.Region,action:"append",Key:e.Key,body:e.Body,qs:{position:e.Position},headers:e.Headers},function(i,o){if(i)return n(i);n(null,o)})}function getAuth(e){var n=this;return util$2.getAuth({SecretId:e.SecretId||this.options.SecretId||"",SecretKey:e.SecretKey||this.options.SecretKey||"",Bucket:e.Bucket,Region:e.Region,Method:e.Method,Key:e.Key,Query:e.Query,Headers:e.Headers,Expires:e.Expires,UseRawKey:n.options.UseRawKey,SystemClockOffset:n.options.SystemClockOffset})}function getObjectUrl(e,n){var t=this,i=e.UseAccelerate===void 0?t.options.UseAccelerate:e.UseAccelerate,o=getUrl({ForcePathStyle:t.options.ForcePathStyle,protocol:e.Protocol||t.options.Protocol,domain:e.Domain||t.options.Domain,bucket:e.Bucket,region:i?"accelerate":e.Region,object:e.Key}),r="";e.Query&&(r+=util$2.obj2str(e.Query)),e.QueryString&&(r+=(r?"&":"")+e.QueryString);var s=o;if(e.Sign!==void 0&&!e.Sign)return r&&(s+="?"+r),n(null,{Url:s}),s;var u=getSignHost.call(this,{Bucket:e.Bucket,Region:e.Region,UseAccelerate:e.UseAccelerate,Url:o}),c=getAuthorizationAsync.call(this,{Action:(e.Method||"").toUpperCase()==="PUT"?"name/cos:PutObject":"name/cos:GetObject",Bucket:e.Bucket||"",Region:e.Region||"",Method:e.Method||"get",Key:e.Key,Expires:e.Expires,Headers:e.Headers,Query:e.Query,SignHost:u,ForceSignHost:e.ForceSignHost===!1?!1:t.options.ForceSignHost},function(f,l){if(!!n){if(f){n(f);return}var a=function(y){var R=y.match(/q-url-param-list.*?(?=&)/g)[0],g="q-url-param-list="+encodeURIComponent(R.replace(/q-url-param-list=/,"")).toLowerCase(),h=new RegExp(R,"g"),C=y.replace(h,g);return C},d=o;d+="?"+(l.Authorization.indexOf("q-signature")>-1?a(l.Authorization):"sign="+encodeURIComponent(l.Authorization)),l.SecurityToken&&(d+="&x-cos-security-token="+l.SecurityToken),l.ClientIP&&(d+="&clientIP="+l.ClientIP),l.ClientUA&&(d+="&clientUA="+l.ClientUA),l.Token&&(d+="&token="+l.Token),r&&(d+="&"+r),setTimeout(function(){n(null,{Url:d})})}});return c?(s+="?"+c.Authorization+(c.SecurityToken?"&x-cos-security-token="+c.SecurityToken:""),r&&(s+="&"+r)):r&&(s+="?"+r),s}function decodeAcl(e){var n={GrantFullControl:[],GrantWrite:[],GrantRead:[],GrantReadAcp:[],GrantWriteAcp:[],ACL:""},t={FULL_CONTROL:"GrantFullControl",WRITE:"GrantWrite",READ:"GrantRead",READ_ACP:"GrantReadAcp",WRITE_ACP:"GrantWriteAcp"},i=e&&e.AccessControlList||{},o=i.Grant;o&&(o=util$2.isArray(o)?o:[o]);var r={READ:0,WRITE:0,FULL_CONTROL:0};return o&&o.length&&util$2.each(o,function(s){s.Grantee.ID==="qcs::cam::anyone:anyone"||s.Grantee.URI==="http://cam.qcloud.com/groups/global/AllUsers"?r[s.Permission]=1:s.Grantee.ID!==e.Owner.ID&&n[t[s.Permission]].push('id="'+s.Grantee.ID+'"')}),r.FULL_CONTROL||r.WRITE&&r.READ?n.ACL="public-read-write":r.READ?n.ACL="public-read":n.ACL="private",util$2.each(t,function(s){n[s]=uniqGrant(n[s].join(","))}),n}function uniqGrant(e){var n=e.split(","),t={},i,o;for(i=0;i<n.length;)o=n[i].trim(),t[o]?n.splice(i,1):(t[o]=!0,n[i]=o,i++);return n.join(",")}function getUrl(e){var n=e.region||"",t=e.bucket||"",i=t.substr(0,t.lastIndexOf("-")),o=t.substr(t.lastIndexOf("-")+1),r=e.domain,s=e.object;typeof r=="function"&&(r=r({Bucket:t,Region:n}));var u=e.protocol||(util$2.isBrowser&&location.protocol==="http:"?"http:":"https:");r||(["cn-south","cn-south-2","cn-north","cn-east","cn-southwest","sg"].indexOf(n)>-1?r="{Region}.myqcloud.com":r="cos.{Region}.myqcloud.com",e.ForcePathStyle||(r="{Bucket}."+r)),r=r.replace(/\{\{AppId\}\}/ig,o).replace(/\{\{Bucket\}\}/ig,i).replace(/\{\{Region\}\}/ig,n).replace(/\{\{.*?\}\}/ig,""),r=r.replace(/\{AppId\}/ig,o).replace(/\{BucketName\}/ig,i).replace(/\{Bucket\}/ig,t).replace(/\{Region\}/ig,n).replace(/\{.*?\}/ig,""),/^[a-zA-Z]+:\/\//.test(r)||(r=u+"//"+r),r.slice(-1)==="/"&&(r=r.slice(0,-1));var c=r;return e.ForcePathStyle&&(c+="/"+t),c+="/",s&&(c+=util$2.camSafeUrlEncode(s).replace(/%2F/g,"/")),e.isLocation&&(c=c.replace(/^https?:\/\//,"")),c}var getSignHost=function(e){if(!e.Bucket||!e.Region)return"";var n=e.UseAccelerate===void 0?this.options.UseAccelerate:e.UseAccelerate,t=e.Url||getUrl({ForcePathStyle:this.options.ForcePathStyle,protocol:this.options.Protocol,domain:this.options.Domain,bucket:e.Bucket,region:n?"accelerate":e.Region}),i=t.replace(/^https?:\/\/([^/]+)(\/.*)?$/,"$1"),o=new RegExp("^([a-z\\d-]+-\\d+\\.)?(cos|cosv6|ci|pic)\\.([a-z\\d-]+)\\.myqcloud\\.com$");return o.test(i)?i:""};function getAuthorizationAsync(e,n){var t=util$2.clone(e.Headers),i="";util$2.each(t,function(v,S){(v===""||["content-type","cache-control","expires"].indexOf(S.toLowerCase())>-1)&&delete t[S],S.toLowerCase()==="host"&&(i=v)});var o=e.ForceSignHost!==!1;!i&&e.SignHost&&o&&(t.Host=e.SignHost);var r=!1,s=function(v,S){r||(r=!0,S&&S.XCosSecurityToken&&!S.SecurityToken&&(S=util$2.clone(S),S.SecurityToken=S.XCosSecurityToken,delete S.XCosSecurityToken),n&&n(v,S))},u=this,c=e.Bucket||"",f=e.Region||"",l=e.Key||"";u.options.ForcePathStyle&&c&&(l=c+"/"+l);var a="/"+l,d={},y=e.Scope;if(!y){var R=e.Action||"",g=e.ResourceKey||e.Key||"";y=e.Scope||[{action:R,bucket:c,region:f,prefix:g}]}var h=util$2.md5(JSON.stringify(y));u._StsCache=u._StsCache||[],function(){var v,S;for(v=u._StsCache.length-1;v>=0;v--){S=u._StsCache[v];var E=Math.round(util$2.getSkewTime(u.options.SystemClockOffset)/1e3)+30;if(S.StartTime&&E<S.StartTime||E>=S.ExpiredTime){u._StsCache.splice(v,1);continue}if(!S.ScopeLimit||S.ScopeLimit&&S.ScopeKey===h){d=S;break}}}();var C=function(){var v="";d.StartTime&&e.Expires?v=d.StartTime+";"+(d.StartTime+e.Expires*1):d.StartTime&&d.ExpiredTime&&(v=d.StartTime+";"+d.ExpiredTime);var S=util$2.getAuth({SecretId:d.TmpSecretId,SecretKey:d.TmpSecretKey,Method:e.Method,Pathname:a,Query:e.Query,Headers:t,Expires:e.Expires,UseRawKey:u.options.UseRawKey,SystemClockOffset:u.options.SystemClockOffset,KeyTime:v,ForceSignHost:o}),E={Authorization:S,SecurityToken:d.SecurityToken||d.XCosSecurityToken||"",Token:d.Token||"",ClientIP:d.ClientIP||"",ClientUA:d.ClientUA||""};s(null,E)},p=function(v){if(v.Authorization){var S=!1,E=v.Authorization;if(E)if(E.indexOf(" ")>-1)S=!1;else if(E.indexOf("q-sign-algorithm=")>-1&&E.indexOf("q-ak=")>-1&&E.indexOf("q-sign-time=")>-1&&E.indexOf("q-key-time=")>-1&&E.indexOf("q-url-param-list=")>-1)S=!0;else try{E=atob(E),E.indexOf("a=")>-1&&E.indexOf("k=")>-1&&E.indexOf("t=")>-1&&E.indexOf("r=")>-1&&E.indexOf("b=")>-1&&(S=!0)}catch{}if(!S)return util$2.error(new Error("getAuthorization callback params format error"))}else{if(!v.TmpSecretId)return util$2.error(new Error('getAuthorization callback params missing "TmpSecretId"'));if(!v.TmpSecretKey)return util$2.error(new Error('getAuthorization callback params missing "TmpSecretKey"'));if(!v.SecurityToken&&!v.XCosSecurityToken)return util$2.error(new Error('getAuthorization callback params missing "SecurityToken"'));if(!v.ExpiredTime)return util$2.error(new Error('getAuthorization callback params missing "ExpiredTime"'));if(v.ExpiredTime&&v.ExpiredTime.toString().length!==10)return util$2.error(new Error('getAuthorization callback params "ExpiredTime" should be 10 digits'));if(v.StartTime&&v.StartTime.toString().length!==10)return util$2.error(new Error('getAuthorization callback params "StartTime" should be 10 StartTime'))}return!1};if(d.ExpiredTime&&d.ExpiredTime-util$2.getSkewTime(u.options.SystemClockOffset)/1e3>60)C();else if(u.options.getAuthorization)u.options.getAuthorization.call(u,{Bucket:c,Region:f,Method:e.Method,Key:l,Pathname:a,Query:e.Query,Headers:t,Scope:y,SystemClockOffset:u.options.SystemClockOffset,ForceSignHost:o},function(v){typeof v=="string"&&(v={Authorization:v});var S=p(v);if(S)return s(S);v.Authorization?s(null,v):(d=v||{},d.Scope=y,d.ScopeKey=h,u._StsCache.push(d),C())});else if(u.options.getSTS)u.options.getSTS.call(u,{Bucket:c,Region:f},function(v){d=v||{},d.Scope=y,d.ScopeKey=h,d.TmpSecretId||(d.TmpSecretId=d.SecretId),d.TmpSecretKey||(d.TmpSecretKey=d.SecretKey);var S=p(d);if(S)return s(S);u._StsCache.push(d),C()});else return function(){var v=util$2.getAuth({SecretId:e.SecretId||u.options.SecretId,SecretKey:e.SecretKey||u.options.SecretKey,Method:e.Method,Pathname:a,Query:e.Query,Headers:t,Expires:e.Expires,UseRawKey:u.options.UseRawKey,SystemClockOffset:u.options.SystemClockOffset,ForceSignHost:o}),S={Authorization:v,SecurityToken:u.options.SecurityToken||u.options.XCosSecurityToken};return s(null,S),S}();return""}function allowRetry(e){var n=!1,t=!1,i=e.headers&&(e.headers.date||e.headers.Date)||e.error&&e.error.ServerTime;try{var o=e.error.Code,r=e.error.Message;(o==="RequestTimeTooSkewed"||o==="AccessDenied"&&r==="Request has expired")&&(t=!0)}catch{}if(e)if(t&&i){var s=Date.parse(i);this.options.CorrectClockSkew&&Math.abs(util$2.getSkewTime(this.options.SystemClockOffset)-s)>=3e4&&(console.error("error: Local time is too skewed."),this.options.SystemClockOffset=s-Date.now(),n=!0)}else Math.floor(e.statusCode/100)===5&&(n=!0);return n}function submitRequest(e,n){var t=this;!e.headers&&(e.headers={}),!e.qs&&(e.qs={}),e.VersionId&&(e.qs.versionId=e.VersionId),e.qs=util$2.clearKey(e.qs),e.headers&&(e.headers=util$2.clearKey(e.headers)),e.qs&&(e.qs=util$2.clearKey(e.qs));var i=util$2.clone(e.qs);e.action&&(i[e.action]="");var o=e.url||e.Url,r=e.SignHost||getSignHost.call(this,{Bucket:e.Bucket,Region:e.Region,Url:o}),s=function(u){var c=t.options.SystemClockOffset;getAuthorizationAsync.call(t,{Bucket:e.Bucket||"",Region:e.Region||"",Method:e.method,Key:e.Key,Query:i,Headers:e.headers,SignHost:r,Action:e.Action,ResourceKey:e.ResourceKey,Scope:e.Scope,ForceSignHost:t.options.ForceSignHost},function(f,l){if(f){n(f);return}e.AuthData=l,_submitRequest.call(t,e,function(a,d){a&&u<2&&(c!==t.options.SystemClockOffset||allowRetry.call(t,a))?(e.headers&&(delete e.headers.Authorization,delete e.headers.token,delete e.headers.clientIP,delete e.headers.clientUA,e.headers["x-cos-security-token"]&&delete e.headers["x-cos-security-token"],e.headers["x-ci-security-token"]&&delete e.headers["x-ci-security-token"]),s(u+1)):n(a,d)})})};s(1)}function _submitRequest(e,n){var t=this,i=e.TaskId;if(!(i&&!t._isRunningTask(i))){var o=e.Bucket,r=e.Region,s=e.Key,u=e.method||"GET",c=e.Url||e.url,f=e.body,l=e.rawBody;t.options.UseAccelerate&&(r="accelerate"),c=c||getUrl({ForcePathStyle:t.options.ForcePathStyle,protocol:t.options.Protocol,domain:t.options.Domain,bucket:o,region:r,object:s}),e.action&&(c=c+"?"+e.action),e.qsStr&&(c.indexOf("?")>-1?c=c+"&"+e.qsStr:c=c+"?"+e.qsStr);var a={method:u,url:c,headers:e.headers,qs:e.qs,body:f},d="x-cos-security-token";if(util$2.isCIHost(c)&&(d="x-ci-security-token"),a.headers.Authorization=e.AuthData.Authorization,e.AuthData.Token&&(a.headers.token=e.AuthData.Token),e.AuthData.ClientIP&&(a.headers.clientIP=e.AuthData.ClientIP),e.AuthData.ClientUA&&(a.headers.clientUA=e.AuthData.ClientUA),e.AuthData.SecurityToken&&(a.headers[d]=e.AuthData.SecurityToken),a.headers&&(a.headers=util$2.clearKey(a.headers)),a=util$2.clearKey(a),e.onProgress&&typeof e.onProgress=="function"){var y=f&&(f.size||f.length)||0;a.onProgress=function(h){if(!(i&&!t._isRunningTask(i))){var C=h?h.loaded:0;e.onProgress({loaded:C,total:y})}}}e.onDownloadProgress&&(a.onDownloadProgress=e.onDownloadProgress),e.DataType&&(a.dataType=e.DataType),this.options.Timeout&&(a.timeout=this.options.Timeout),t.options.ForcePathStyle&&(a.pathStyle=t.options.ForcePathStyle),t.emit("before-send",a);var R=(t.options.Request||REQUEST)(a,function(h){if(h.error!=="abort"){var C={options:a,error:v,statusCode:p&&p.statusCode||0,headers:p&&p.headers||{},body:S};t.emit("after-receive",C),v=C.error,S=C.body,p={statusCode:C.statusCode,headers:C.headers},t.emit("after-receive",h);var p={statusCode:h.statusCode,statusMessage:h.statusMessage,headers:h.headers},v=h.error,S=h.body,E,T=function(x,N){if(i&&t.off("inner-kill-task",g),!E){E=!0;var P={};p&&p.statusCode&&(P.statusCode=p.statusCode),p&&p.headers&&(P.headers=p.headers),x?(x=util$2.extend(x||{},P),n(x,null)):(N=util$2.extend(N||{},P),n(null,N)),R=null}};if(v)return T(util$2.error(v));var m=p.statusCode,_=Math.floor(m/100)===2;if(l&&_)return T(null,{body:S});var A;try{A=S&&S.indexOf("<")>-1&&S.indexOf(">")>-1&&util$2.xml2json(S)||{}}catch{A={}}var k=A&&A.Error;_?T(null,A):k?T(util$2.error(new Error(k.Message),{code:k.Code,error:k})):m?T(util$2.error(new Error(p.statusMessage),{code:""+m})):m&&T(util$2.error(new Error("statusCode error")))}}),g=function(h){h.TaskId===i&&(R&&R.abort&&R.abort(),t.off("inner-kill-task",g))};i&&t.on("inner-kill-task",g)}}var API_MAP$1={getService,putBucket,headBucket,getBucket,deleteBucket,putBucketAcl,getBucketAcl,putBucketCors,getBucketCors,deleteBucketCors,getBucketLocation,getBucketPolicy,putBucketPolicy,deleteBucketPolicy,putBucketTagging,getBucketTagging,deleteBucketTagging,putBucketLifecycle,getBucketLifecycle,deleteBucketLifecycle,putBucketVersioning,getBucketVersioning,putBucketReplication,getBucketReplication,deleteBucketReplication,putBucketWebsite,getBucketWebsite,deleteBucketWebsite,putBucketReferer,getBucketReferer,putBucketDomain,getBucketDomain,deleteBucketDomain,putBucketOrigin,getBucketOrigin,deleteBucketOrigin,putBucketLogging,getBucketLogging,putBucketInventory,getBucketInventory,listBucketInventory,deleteBucketInventory,putBucketAccelerate,getBucketAccelerate,putBucketEncryption,getBucketEncryption,deleteBucketEncryption,getObject,headObject,listObjectVersions,putObject,deleteObject,getObjectAcl,putObjectAcl,optionsObject,putObjectCopy,deleteMultipleObject,restoreObject,putObjectTagging,getObjectTagging,deleteObjectTagging,selectObjectContent,appendObject,uploadPartCopy,multipartInit,multipartUpload,multipartComplete,multipartList,multipartListPart,multipartAbort,request,getObjectUrl,getAuth};function warnOldApi(e,n,t){util$2.each(["Cors","Acl"],function(i){if(e.slice(-i.length)===i){var o=e.slice(0,-i.length)+i.toUpperCase(),r=util$2.apiWrapper(e,n),s=!1;t[o]=function(){!s&&console.warn("warning: cos."+o+" has been deprecated. Please Use cos."+e+" instead."),s=!0,r.apply(this,arguments)}}})}base$1.init=function(e,n){n.transferToTaskMethod(API_MAP$1,"putObject"),util$2.each(API_MAP$1,function(t,i){e.prototype[i]=util$2.apiWrapper(i,t),warnOldApi(i,t,e.prototype)})};var advance$1={},eachLimit=function(e,n,t,i){if(i=i||function(){},!e.length||n<=0)return i();var o=0,r=0,s=0;(function u(){if(o>=e.length)return i();for(;s<n&&r<e.length;)r+=1,s+=1,t(e[r-1],function(c){c?(i(c),i=function(){}):(o+=1,s-=1,o>=e.length?i():u())})})()},retry=function(e,n,t){var i=function(o){n(function(r,s){r&&o<e?i(o+1):t(r,s)})};e<1?t():i(1)},async={eachLimit,retry},async_1=async,session=session$2,Async=async_1,EventProxy=event$1.EventProxy,util$1=util_1;function sliceUploadFile(e,n){var t=this,i=new EventProxy,o=e.TaskId,r=e.Bucket,s=e.Region,u=e.Key,c=e.Body,f=e.ChunkSize||e.SliceSize||t.options.ChunkSize,l=e.AsyncLimit,a=e.StorageClass,d=e.ServerSideEncryption,y,R,g=e.onHashProgress;i.on("error",function(h){if(!!t._isRunningTask(o))return h.UploadId=e.UploadData.UploadId||"",n(h)}),i.on("upload_complete",function(h){var C=util$1.extend({UploadId:e.UploadData.UploadId||""},h);n(null,C)}),i.on("upload_slice_complete",function(h){var C={};util$1.each(e.Headers,function(p,v){var S=v.toLowerCase();(S.indexOf("x-cos-meta-")===0||S==="pic-operations")&&(C[v]=p)}),uploadSliceComplete.call(t,{Bucket:r,Region:s,Key:u,UploadId:h.UploadId,SliceList:h.SliceList,Headers:C},function(p,v){if(!!t._isRunningTask(o)){if(session.removeUsing(h.UploadId),p)return R(null,!0),i.emit("error",p);session.removeUploadId.call(t,h.UploadId),R({loaded:y,total:y},!0),i.emit("upload_complete",v)}})}),i.on("get_upload_data_finish",function(h){var C=session.getFileId(c,e.ChunkSize,r,u);C&&session.saveUploadId.call(t,C,h.UploadId,t.options.UploadIdCacheLimit),session.setUsing(h.UploadId),R(null,!0),uploadSliceList.call(t,{TaskId:o,Bucket:r,Region:s,Key:u,Body:c,FileSize:y,SliceSize:f,AsyncLimit:l,ServerSideEncryption:d,UploadData:h,Headers:e.Headers,onProgress:R},function(p,v){if(!!t._isRunningTask(o)){if(p)return R(null,!0),i.emit("error",p);i.emit("upload_slice_complete",v)}})}),i.on("get_file_size_finish",function(){if(R=util$1.throttleOnProgress.call(t,y,e.onProgress),e.UploadData.UploadId)i.emit("get_upload_data_finish",e.UploadData);else{var h=util$1.extend({TaskId:o,Bucket:r,Region:s,Key:u,Headers:e.Headers,StorageClass:a,Body:c,FileSize:y,SliceSize:f,onHashProgress:g},e);getUploadIdAndPartList.call(t,h,function(C,p){if(!!t._isRunningTask(o)){if(C)return i.emit("error",C);e.UploadData.UploadId=p.UploadId,e.UploadData.PartList=p.PartList,i.emit("get_upload_data_finish",e.UploadData)}})}}),y=e.ContentLength,delete e.ContentLength,!e.Headers&&(e.Headers={}),util$1.each(e.Headers,function(h,C){C.toLowerCase()==="content-length"&&delete e.Headers[C]}),function(){for(var h=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,5120],C=1024*1024,p=0;p<h.length&&(C=h[p]*1024*1024,!(y/C<=t.options.MaxPartNumber));p++);e.ChunkSize=e.SliceSize=f=Math.max(f,C)}(),y===0?(e.Body="",e.ContentLength=0,e.SkipTask=!0,t.putObject(e,n)):i.emit("get_file_size_finish")}function getUploadIdAndPartList(e,n){var t=e.TaskId,i=e.Bucket,o=e.Region,r=e.Key,s=e.StorageClass,u=this,c={},f=e.FileSize,l=e.SliceSize,a=Math.ceil(f/l),d=0,y=util$1.throttleOnProgress.call(u,f,e.onHashProgress),R=function(C,p){var v=l*(C-1),S=Math.min(v+l,f),E=S-v;c[C]?p(null,{PartNumber:C,ETag:c[C],Size:E}):util$1.fileSlice(e.Body,v,S,!1,function(T){util$1.getFileMd5(T,function(m,_){if(m)return p(util$1.error(m));var A='"'+_+'"';c[C]=A,d+=E,y({loaded:d,total:f}),p(null,{PartNumber:C,ETag:A,Size:E})})})},g=function(C,p){var v=C.length;if(v===0)return p(null,!0);if(v>a)return p(null,!1);if(v>1){var S=Math.max(C[0].Size,C[1].Size);if(S!==l)return p(null,!1)}var E=function(T){if(T<v){var m=C[T];R(m.PartNumber,function(_,A){A&&A.ETag===m.ETag&&A.Size===m.Size?E(T+1):p(null,!1)})}else p(null,!0)};E(0)},h=new EventProxy;h.on("error",function(C){if(!!u._isRunningTask(t))return n(C)}),h.on("upload_id_available",function(C){var p={},v=[];util$1.each(C.PartList,function(T){p[T.PartNumber]=T});for(var S=1;S<=a;S++){var E=p[S];E?(E.PartNumber=S,E.Uploaded=!0):E={PartNumber:S,ETag:null,Uploaded:!1},v.push(E)}C.PartList=v,n(null,C)}),h.on("no_available_upload_id",function(){if(!!u._isRunningTask(t)){var C=util$1.extend({Bucket:i,Region:o,Key:r,Query:util$1.clone(e.Query),StorageClass:s,Body:e.Body},e),p=util$1.clone(e.Headers);delete p["x-cos-mime-limit"],C.Headers=p,u.multipartInit(C,function(v,S){if(!!u._isRunningTask(t)){if(v)return h.emit("error",v);var E=S.UploadId;if(!E)return n(util$1.error(new Error("no such upload id")));h.emit("upload_id_available",{UploadId:E,PartList:[]})}})}}),h.on("has_and_check_upload_id",function(C){C=C.reverse(),Async.eachLimit(C,1,function(p,v){if(!!u._isRunningTask(t)){if(session.using[p]){v();return}wholeMultipartListPart.call(u,{Bucket:i,Region:o,Key:r,UploadId:p},function(S,E){if(!!u._isRunningTask(t)){if(S)return session.removeUsing(p),h.emit("error",S);var T=E.PartList;T.forEach(function(m){m.PartNumber*=1,m.Size*=1,m.ETag=m.ETag||""}),g(T,function(m,_){if(!!u._isRunningTask(t)){if(m)return h.emit("error",m);_?v({UploadId:p,PartList:T}):v()}})}})}},function(p){!u._isRunningTask(t)||(y(null,!0),p&&p.UploadId?h.emit("upload_id_available",p):h.emit("no_available_upload_id"))})}),h.on("seek_local_avail_upload_id",function(C){var p=session.getFileId(e.Body,e.ChunkSize,i,r),v=session.getUploadIdList.call(u,p);if(!p||!v){h.emit("has_and_check_upload_id",C);return}var S=function(E){if(E>=v.length){h.emit("has_and_check_upload_id",C);return}var T=v[E];if(!util$1.isInArray(C,T)){session.removeUploadId.call(u,T),S(E+1);return}if(session.using[T]){S(E+1);return}wholeMultipartListPart.call(u,{Bucket:i,Region:o,Key:r,UploadId:T},function(m,_){!u._isRunningTask(t)||(m?(session.removeUploadId.call(u,T),S(E+1)):h.emit("upload_id_available",{UploadId:T,PartList:_.PartList}))})};S(0)}),h.on("get_remote_upload_id_list",function(){wholeMultipartList.call(u,{Bucket:i,Region:o,Key:r},function(C,p){if(!!u._isRunningTask(t)){if(C)return h.emit("error",C);var v=util$1.filter(p.UploadList,function(T){return T.Key===r&&(!s||T.StorageClass.toUpperCase()===s.toUpperCase())}).reverse().map(function(T){return T.UploadId||T.UploadID});if(v.length)h.emit("seek_local_avail_upload_id",v);else{var S=session.getFileId(e.Body,e.ChunkSize,i,r),E;S&&(E=session.getUploadIdList.call(u,S))&&util$1.each(E,function(T){session.removeUploadId.call(u,T)}),h.emit("no_available_upload_id")}}})}),h.emit("get_remote_upload_id_list")}function wholeMultipartList(e,n){var t=this,i=[],o={Bucket:e.Bucket,Region:e.Region,Prefix:e.Key},r=function(){t.multipartList(o,function(s,u){if(s)return n(s);i.push.apply(i,u.Upload||[]),u.IsTruncated==="true"?(o.KeyMarker=u.NextKeyMarker,o.UploadIdMarker=u.NextUploadIdMarker,r()):n(null,{UploadList:i})})};r()}function wholeMultipartListPart(e,n){var t=this,i=[],o={Bucket:e.Bucket,Region:e.Region,Key:e.Key,UploadId:e.UploadId},r=function(){t.multipartListPart(o,function(s,u){if(s)return n(s);i.push.apply(i,u.Part||[]),u.IsTruncated==="true"?(o.PartNumberMarker=u.NextPartNumberMarker,r()):n(null,{PartList:i})})};r()}function uploadSliceList(e,n){var t=this,i=e.TaskId,o=e.Bucket,r=e.Region,s=e.Key,u=e.UploadData,c=e.FileSize,f=e.SliceSize,l=Math.min(e.AsyncLimit||t.options.ChunkParallelLimit||1,256),a=e.Body,d=Math.ceil(c/f),y=0,R=e.ServerSideEncryption,g=e.Headers,h=util$1.filter(u.PartList,function(p){return p.Uploaded&&(y+=p.PartNumber>=d&&c%f||f),!p.Uploaded}),C=e.onProgress;Async.eachLimit(h,l,function(p,v){if(!!t._isRunningTask(i)){var S=p.PartNumber,E=Math.min(c,p.PartNumber*f)-(p.PartNumber-1)*f,T=0;uploadSliceItem.call(t,{TaskId:i,Bucket:o,Region:r,Key:s,SliceSize:f,FileSize:c,PartNumber:S,ServerSideEncryption:R,Body:a,UploadData:u,Headers:g,onProgress:function(m){y+=m.loaded-T,T=m.loaded,C({loaded:y,total:c})}},function(m,_){!t._isRunningTask(i)||(!m&&!_.ETag&&(m='get ETag error, please add "ETag" to CORS ExposeHeader setting.( \u83B7\u53D6ETag\u5931\u8D25\uFF0C\u8BF7\u5728CORS ExposeHeader\u8BBE\u7F6E\u4E2D\u6DFB\u52A0ETag\uFF0C\u8BF7\u53C2\u8003\u6587\u6863\uFF1Ahttps://cloud.tencent.com/document/product/436/13318 )'),m?y-=T:(y+=E-T,p.ETag=_.ETag),C({loaded:y,total:c}),v(m||null,_))})}},function(p){if(!!t._isRunningTask(i)){if(p)return n(p);n(null,{UploadId:u.UploadId,SliceList:u.PartList})}})}function uploadSliceItem(e,n){var t=this,i=e.TaskId,o=e.Bucket,r=e.Region,s=e.Key,u=e.FileSize,c=e.Body,f=e.PartNumber*1,l=e.SliceSize,a=e.ServerSideEncryption,d=e.UploadData,y=e.Headers||{},R=t.options.ChunkRetryTimes+1,g=l*(f-1),h=l,C=g+l;C>u&&(C=u,h=C-g);var p=["x-cos-traffic-limit","x-cos-mime-limit"],v={};util$1.each(y,function(E,T){p.indexOf(T)>-1&&(v[T]=E)});var S=d.PartList[f-1];Async.retry(R,function(E){!t._isRunningTask(i)||util$1.fileSlice(c,g,C,!0,function(T){t.multipartUpload({TaskId:i,Bucket:o,Region:r,Key:s,ContentLength:h,PartNumber:f,UploadId:d.UploadId,ServerSideEncryption:a,Body:T,Headers:v,onProgress:e.onProgress},function(m,_){if(!!t._isRunningTask(i))return m?E(m):(S.Uploaded=!0,E(null,_))})})},function(E,T){if(!!t._isRunningTask(i))return n(E,T)})}function uploadSliceComplete(e,n){var t=e.Bucket,i=e.Region,o=e.Key,r=e.UploadId,s=e.SliceList,u=this,c=this.options.ChunkRetryTimes+1,f=e.Headers,l=s.map(function(a){return{PartNumber:a.PartNumber,ETag:a.ETag}});Async.retry(c,function(a){u.multipartComplete({Bucket:t,Region:i,Key:o,UploadId:r,Parts:l,Headers:f},a)},function(a,d){n(a,d)})}function abortUploadTask(e,n){var t=e.Bucket,i=e.Region,o=e.Key,r=e.UploadId,s=e.Level||"task",u=e.AsyncLimit,c=this,f=new EventProxy;if(f.on("error",function(l){return n(l)}),f.on("get_abort_array",function(l){abortUploadTaskArray.call(c,{Bucket:t,Region:i,Key:o,Headers:e.Headers,AsyncLimit:u,AbortArray:l},n)}),s==="bucket")wholeMultipartList.call(c,{Bucket:t,Region:i},function(l,a){if(l)return n(l);f.emit("get_abort_array",a.UploadList||[])});else if(s==="file"){if(!o)return n(util$1.error(new Error("abort_upload_task_no_key")));wholeMultipartList.call(c,{Bucket:t,Region:i,Key:o},function(l,a){if(l)return n(l);f.emit("get_abort_array",a.UploadList||[])})}else if(s==="task"){if(!r)return n(util$1.error(new Error("abort_upload_task_no_id")));if(!o)return n(util$1.error(new Error("abort_upload_task_no_key")));f.emit("get_abort_array",[{Key:o,UploadId:r}])}else return n(util$1.error(new Error("abort_unknown_level")))}function abortUploadTaskArray(e,n){var t=e.Bucket,i=e.Region,o=e.Key,r=e.AbortArray,s=e.AsyncLimit||1,u=this,c=0,f=new Array(r.length);Async.eachLimit(r,s,function(l,a){var d=c;if(o&&o!==l.Key){f[d]={error:{KeyNotMatch:!0}},a(null);return}var y=l.UploadId||l.UploadID;u.multipartAbort({Bucket:t,Region:i,Key:l.Key,Headers:e.Headers,UploadId:y},function(R){var g={Bucket:t,Region:i,Key:l.Key,UploadId:y};f[d]={error:R,task:g},a(null)}),c++},function(l){if(l)return n(l);for(var a=[],d=[],y=0,R=f.length;y<R;y++){var g=f[y];g.task&&(g.error?d.push(g.task):a.push(g.task))}return n(null,{successList:a,errorList:d})})}function uploadFile(e,n){var t=this,i=e.SliceSize===void 0?t.options.SliceSize:e.SliceSize,o=[],r=e.Body,s=r.size||r.length||0,u={TaskId:""};util$1.each(e,function(y,R){typeof y!="object"&&typeof y!="function"&&(u[R]=y)});var c=e.onTaskReady,f=function(y){u.TaskId=y,c&&c(y)};e.onTaskReady=f;var l=e.onFileFinish,a=function(y,R){l&&l(y,R,u),n&&n(y,R)},d=s>i?"sliceUploadFile":"putObject";o.push({api:d,params:e,callback:a}),t._addTasks(o)}function uploadFiles(e,n){var t=this,i=e.SliceSize===void 0?t.options.SliceSize:e.SliceSize,o=0,r=0,s=util$1.throttleOnProgress.call(t,r,e.onProgress),u=e.files.length,c=e.onFileFinish,f=Array(u),l=function(d,y,R){s(null,!0),c&&c(d,y,R),f[R.Index]={options:R,error:d,data:y},--u<=0&&n&&n(null,{files:f})},a=[];util$1.each(e.files,function(d,y){(function(){var R=d.Body,g=R.size||R.length||0,h={Index:y,TaskId:""};o+=g,util$1.each(d,function(A,k){typeof A!="object"&&typeof A!="function"&&(h[k]=A)});var C=d.onTaskReady,p=function(A){h.TaskId=A,C&&C(A)};d.onTaskReady=p;var v=0,S=d.onProgress,E=function(A){r=r-v+A.loaded,v=A.loaded,S&&S(A),s({loaded:r,total:o})};d.onProgress=E;var T=d.onFileFinish,m=function(A,k){T&&T(A,k),l&&l(A,k,h)},_=g>i?"sliceUploadFile":"putObject";a.push({api:_,params:d,callback:m})})()}),t._addTasks(a)}function sliceCopyFile(e,n){var t=new EventProxy,i=this,o=e.Bucket,r=e.Region,s=e.Key,u=e.CopySource,c=util$1.getSourceParams.call(this,u);if(!c){n(util$1.error(new Error("CopySource format error")));return}var f=c.Bucket,l=c.Region,a=decodeURIComponent(c.Key),d=e.CopySliceSize===void 0?i.options.CopySliceSize:e.CopySliceSize;d=Math.max(0,d);var y=e.CopyChunkSize||this.options.CopyChunkSize,R=this.options.CopyChunkParallelLimit,g=0,h,C;t.on("copy_slice_complete",function(p){util$1.each(e.Headers,function(S,E){E.toLowerCase().indexOf("x-cos-meta-")});var v=util$1.map(p.PartList,function(S){return{PartNumber:S.PartNumber,ETag:S.ETag}});i.multipartComplete({Bucket:o,Region:r,Key:s,UploadId:p.UploadId,Parts:v},function(S,E){if(S)return C(null,!0),n(S);C({loaded:h,total:h},!0),n(null,E)})}),t.on("get_copy_data_finish",function(p){Async.eachLimit(p.PartList,R,function(v,S){var E=v.PartNumber,T=v.CopySourceRange,m=v.end-v.start;copySliceItem.call(i,{Bucket:o,Region:r,Key:s,CopySource:u,UploadId:p.UploadId,PartNumber:E,CopySourceRange:T},function(_,A){if(_)return S(_);g+=m,C({loaded:g,total:h}),v.ETag=A.ETag,S(_||null,A)})},function(v){if(v)return C(null,!0),n(v);t.emit("copy_slice_complete",p)})}),t.on("get_file_size_finish",function(p){(function(){for(var E=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,5120],T=1024*1024,m=0;m<E.length&&(T=E[m]*1024*1024,!(h/T<=i.options.MaxPartNumber));m++);e.ChunkSize=y=Math.max(y,T);for(var _=Math.ceil(h/y),A=[],k=1;k<=_;k++){var x=(k-1)*y,N=k*y<h?k*y-1:h-1,P={PartNumber:k,start:x,end:N,CopySourceRange:"bytes="+x+"-"+N};A.push(P)}e.PartList=A})();var v;if(e.Headers["x-cos-metadata-directive"]==="Replaced"?v=e.Headers:v=p,v["x-cos-storage-class"]=e.Headers["x-cos-storage-class"]||p["x-cos-storage-class"],v=util$1.clearKey(v),p["x-cos-storage-class"]==="ARCHIVE"||p["x-cos-storage-class"]==="DEEP_ARCHIVE"){var S=p["x-cos-restore"];if(!S||S==='ongoing-request="true"'){n(util$1.error(new Error("Unrestored archive object is not allowed to be copied")));return}}delete v["x-cos-copy-source"],delete v["x-cos-metadata-directive"],delete v["x-cos-copy-source-If-Modified-Since"],delete v["x-cos-copy-source-If-Unmodified-Since"],delete v["x-cos-copy-source-If-Match"],delete v["x-cos-copy-source-If-None-Match"],i.multipartInit({Bucket:o,Region:r,Key:s,Headers:v},function(E,T){if(E)return n(E);e.UploadId=T.UploadId,t.emit("get_copy_data_finish",e)})}),i.headObject({Bucket:f,Region:l,Key:a},function(p,v){if(p){p.statusCode&&p.statusCode===404?n(util$1.error(p,{ErrorStatus:a+" Not Exist"})):n(p);return}if(h=e.FileSize=v.headers["content-length"],h===void 0||!h){n(util$1.error(new Error('get Content-Length error, please add "Content-Length" to CORS ExposeHeader setting.\uFF08 \u83B7\u53D6Content-Length\u5931\u8D25\uFF0C\u8BF7\u5728CORS ExposeHeader\u8BBE\u7F6E\u4E2D\u6DFB\u52A0Content-Length\uFF0C\u8BF7\u53C2\u8003\u6587\u6863\uFF1Ahttps://cloud.tencent.com/document/product/436/13318 \uFF09')));return}if(C=util$1.throttleOnProgress.call(i,h,e.onProgress),h<=d)e.Headers["x-cos-metadata-directive"]||(e.Headers["x-cos-metadata-directive"]="Copy"),i.putObjectCopy(e,function(T,m){if(T)return C(null,!0),n(T);C({loaded:h,total:h},!0),n(T,m)});else{var S=v.headers,E={"Cache-Control":S["cache-control"],"Content-Disposition":S["content-disposition"],"Content-Encoding":S["content-encoding"],"Content-Type":S["content-type"],Expires:S.expires,"x-cos-storage-class":S["x-cos-storage-class"]};util$1.each(S,function(T,m){var _="x-cos-meta-";m.indexOf(_)===0&&m.length>_.length&&(E[m]=T)}),t.emit("get_file_size_finish",E)}})}function copySliceItem(e,n){var t=e.TaskId,i=e.Bucket,o=e.Region,r=e.Key,s=e.CopySource,u=e.UploadId,c=e.PartNumber*1,f=e.CopySourceRange,l=this.options.ChunkRetryTimes+1,a=this;Async.retry(l,function(d){a.uploadPartCopy({TaskId:t,Bucket:i,Region:o,Key:r,CopySource:s,UploadId:u,PartNumber:c,CopySourceRange:f},function(y,R){d(y||null,R)})},function(d,y){return n(d,y)})}var API_MAP={sliceUploadFile,abortUploadTask,uploadFile,uploadFiles,sliceCopyFile};advance$1.init=function(e,n){n.transferToTaskMethod(API_MAP,"sliceUploadFile"),util$1.each(API_MAP,function(t,i){e.prototype[i]=util$1.apiWrapper(i,t)})};var util=util_1,event=event$1,task=task$1,base=base$1,advance=advance$1,defaultOptions={AppId:"",SecretId:"",SecretKey:"",SecurityToken:"",ChunkRetryTimes:2,FileParallelLimit:3,ChunkParallelLimit:3,ChunkSize:1024*1024,SliceSize:1024*1024,CopyChunkParallelLimit:20,CopyChunkSize:1024*1024*10,CopySliceSize:1024*1024*10,MaxPartNumber:1e4,ProgressInterval:1e3,Domain:"",ServiceDomain:"",Protocol:"",CompatibilityMode:!1,ForcePathStyle:!1,UseRawKey:!1,Timeout:0,CorrectClockSkew:!0,SystemClockOffset:0,UploadCheckContentMd5:!1,UploadQueueSize:1e4,UploadAddMetaMd5:!1,UploadIdCacheLimit:50,UseAccelerate:!1,ForceSignHost:!0},COS$1=function(e){this.options=util.extend(util.clone(defaultOptions),e||{}),this.options.FileParallelLimit=Math.max(1,this.options.FileParallelLimit),this.options.ChunkParallelLimit=Math.max(1,this.options.ChunkParallelLimit),this.options.ChunkRetryTimes=Math.max(0,this.options.ChunkRetryTimes),this.options.ChunkSize=Math.max(1024*1024,this.options.ChunkSize),this.options.CopyChunkParallelLimit=Math.max(1,this.options.CopyChunkParallelLimit),this.options.CopyChunkSize=Math.max(1024*1024,this.options.CopyChunkSize),this.options.CopySliceSize=Math.max(0,this.options.CopySliceSize),this.options.MaxPartNumber=Math.max(1024,Math.min(1e4,this.options.MaxPartNumber)),this.options.Timeout=Math.max(0,this.options.Timeout),this.options.AppId&&console.warn('warning: AppId has been deprecated, Please put it at the end of parameter Bucket(E.g: "test-1250000000").'),this.options.SecretId&&this.options.SecretId.indexOf(" ")>-1&&(console.error("error: SecretId\u683C\u5F0F\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5"),console.error("error: SecretId format is incorrect. Please check")),this.options.SecretKey&&this.options.SecretKey.indexOf(" ")>-1&&(console.error("error: SecretKey\u683C\u5F0F\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5"),console.error("error: SecretKey format is incorrect. Please check")),util.isNode()&&(console.warn("warning: cos-js-sdk-v5 \u4E0D\u652F\u6301 nodejs \u73AF\u5883\u4F7F\u7528\uFF0C\u8BF7\u6539\u7528 cos-nodejs-sdk-v5\uFF0C\u53C2\u8003\u6587\u6863\uFF1A https://cloud.tencent.com/document/product/436/8629"),console.warn("warning: cos-js-sdk-v5 does not support nodejs environment. Please use cos-nodejs-sdk-v5 instead. See: https://cloud.tencent.com/document/product/436/8629")),event.init(this),task.init(this)};base.init(COS$1,task);advance.init(COS$1,task);COS$1.util={md5:util.md5,xml2json:util.xml2json,json2xml:util.json2xml};COS$1.getAuthorization=util.getAuth;COS$1.version="1.3.9";var cos=COS$1,COS=cos,_cosJsSdkV5_1_3_9_cosJsSdkV5=COS;function newClient(e){let n=null;const t=e.secretId,i=e.secretKey,o=e.getAuthorization;return o?n=new _cosJsSdkV5_1_3_9_cosJsSdkV5({getAuthorization(r,s){o(r).then(u=>{u.ExpiredTime&&typeof u.ExpiredTime=="string"&&(u.ExpiredTime=dayjs(u.ExpiredTime).unix()),s(u)})}}):(console.warn("\u60A8\u8FD8\u672A\u914D\u7F6EgetAuthorization\uFF0C\u5C06\u4F7F\u7528SecretKey\u6388\u6743\u8FDB\u884C\u4E0A\u4F20"),n=new _cosJsSdkV5_1_3_9_cosJsSdkV5({SecretId:t,SecretKey:i})),n}async function doUpload({file:e,fileName:n,onProgress:t,options:i}){const o=await buildKey(e,n,i),r=i,s=newClient(i);return new Promise((u,c)=>{s.putObject({Bucket:r.bucket,Region:r.region,Key:o,Body:e,onProgress(f){const l=f;l.total>0&&(l.percent=Math.floor(l.loaded/l.total*100)),t(l)}},async function(f,l){if(f!=null){console.error(f),c(f);return}let a={url:r.domain+"/"+o,key:o};if(r.successHandle){a=await r.successHandle(a),u(a);return}u(a)})})}const _sfc_main={name:"FsUploaderCos",setup(){const{proxy:e}=getCurrentInstance(),{getConfig:n}=useUploader(e),t=n("cos");async function i(o){const r=o.options,s=lodash.merge(lodash.cloneDeep(t),r);return o.options=s,await doUpload(o)}return{upload:i}}},_hoisted_1={class:"fs-uploader-cos"};function _sfc_render(e,n,t,i,o,r){return openBlock(),createElementBlock("span",_hoisted_1)}var fsUploaderCos=_export_sfc(_sfc_main,[["render",_sfc_render]]);export{fsUploaderCos as default};
